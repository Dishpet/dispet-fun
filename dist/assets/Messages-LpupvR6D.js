import{l as v,r as t,j as e,aD as X,B as r,a as Z,x as q,O,T as F,V as P,W as D,aE as E,g as n,I as j,aF as R,a3 as i}from"./index-BKHBW7nG.js";import{T}from"./textarea-kRObkkml.js";import{B as K}from"./badge-VGBY9r7f.js";import{R as Q}from"./refresh-cw-DW34DT4M.js";import{M as Y}from"./mail-Dou-kzD2.js";import{C as _}from"./clock-HQu2rO1K.js";import{T as ee}from"./trash-2-C05tmBfp.js";import{S as se}from"./send-BknlmpkG.js";import{f as ae,h as te}from"./hr-DgTxfRwo.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=v("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=v("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=v("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]),xe=()=>{const[d,g]=t.useState([]),[U,B]=t.useState(!0),[I,w]=t.useState(!1),[a,N]=t.useState(null),[A,c]=t.useState(!1),[H,m]=t.useState(!1),[b,y]=t.useState(""),[k,V]=t.useState(""),[S,C]=t.useState(""),[p,x]=t.useState(!1),u=async(s=!1)=>{s&&w(!0);try{const o=await fetch("/api/messages");if(o.ok){const h=await o.json();g(h)}}catch(l){console.error("Failed to fetch messages",l),i.error("Greška pri osvježavanju poruka")}finally{B(!1),s&&w(!1)}};t.useEffect(()=>{u();const s=setInterval(()=>u(!1),3e4);return()=>clearInterval(s)},[]);const L=async s=>{const l=[...d];g(o=>o.filter(h=>h.id!==s)),i.promise(async()=>{const o=`/api/messages/${s}`;if(!(await fetch(o,{method:"DELETE"})).ok)throw new Error("Failed")},{loading:"Brisanje...",success:"Poruka obrisana",error:()=>(g(l),"Neuspješno brisanje")})},J=s=>{N(s),y(`

Poštovani/a ${s.name},

Hvala na vašem upitu.

Srdačan pozdrav,
Dišpet Tim`),c(!0)},$=s=>{N(s),C("Ovdje prosljeđujem ovaj upit..."),m(!0)},G=async()=>{if(a){x(!0);try{if((await fetch("/api/messages/reply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:a.email,subject:"Re: Vaša poruka za Dišpet",body:b})})).ok)i.success("Odgovor uspješno poslan!"),c(!1);else throw new Error("Send failed")}catch(s){console.error(s),i.error("Slanje nije uspjelo")}finally{x(!1)}}},W=async()=>{if(a){x(!0);try{if((await fetch("/api/messages/forward",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:k,subject:`Fwd: Poruka od ${a.name}`,body:S,originalMessage:a})})).ok)i.success("Poruka uspješno proslijeđena!"),m(!1);else throw new Error("Send failed")}catch(s){console.error(s),i.error("Slanje nije uspjelo")}finally{x(!1)}}};return U?e.jsx("div",{className:"flex h-[50vh] w-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 animate-pulse",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(z,{className:"h-6 w-6 text-primary"})}),e.jsx("p",{className:"text-muted-foreground font-medium",children:"Učitavanje inboxa..."})]})}):e.jsx(X,{children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold font-heading bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Inbox"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-lg",children:"Upravljajte porukama posjetitelja i kupaca."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{variant:"secondary",className:"px-3 py-1 text-sm h-9",children:["Ukupno: ",d.length]}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>u(!0),className:I?"animate-spin":"",children:e.jsx(Q,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 text-center bg-white rounded-[3rem] border border-dashed border-slate-200 shadow-sm",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-slate-50 flex items-center justify-center mb-8 shadow-inner",children:e.jsx(z,{className:"h-10 w-10 text-slate-300"})}),e.jsx("h3",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"VAŠ INBOX JE PRAZAN"}),e.jsx("p",{className:"text-slate-500 max-w-xs mt-3 font-medium leading-relaxed",children:"Nove poruke s kontakt forme pojavit će se ovdje automatski."})]}):e.jsx("div",{className:"grid gap-6",children:d.map(s=>e.jsxs(Z,{className:"group relative overflow-hidden transition-all duration-500 hover:shadow-2xl hover:shadow-slate-200 border-none bg-white rounded-[2.5rem]",children:[e.jsx("div",{className:"absolute top-0 left-0 w-2 h-full bg-primary opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsxs("div",{className:"flex items-start gap-5 min-w-[240px]",children:[e.jsx("div",{className:"h-16 w-16 shrink-0 rounded-3xl bg-gradient-to-br from-slate-800 to-slate-900 flex items-center justify-center text-white font-black text-2xl shadow-xl transform group-hover:rotate-6 transition-transform",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-lg font-black text-slate-900 tracking-tight leading-none pt-1",children:s.name}),e.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[e.jsxs("span",{className:"flex items-center gap-2 text-xs font-bold text-slate-400 hover:text-primary transition-colors cursor-pointer truncate",children:[e.jsx(Y,{className:"w-3.5 h-3.5"})," ",s.email]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-2 text-xs font-bold text-slate-400",children:[e.jsx(q,{className:"w-3.5 h-3.5"})," ",s.phone]})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0 py-2 lg:px-8 lg:border-l lg:border-slate-100",children:e.jsx("div",{className:"text-slate-600 font-medium leading-relaxed whitespace-pre-wrap text-sm lg:text-base",children:s.message})}),e.jsxs("div",{className:"flex sm:flex-row lg:flex-col items-center lg:items-end justify-between lg:justify-start gap-6 min-w-[160px] lg:pl-4 lg:border-l lg:border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-slate-400 uppercase tracking-widest bg-slate-50 px-3 py-1.5 rounded-full border border-slate-100",children:[e.jsx(_,{className:"w-3.5 h-3.5"}),ae(new Date(s.date),"dd. MMM, HH:mm",{locale:te})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx(r,{variant:"ghost",size:"icon",className:"h-12 w-12 rounded-2xl text-blue-600 bg-blue-50/50 hover:bg-blue-600 hover:text-white transition-all shadow-sm",onClick:()=>J(s),children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx(r,{variant:"ghost",size:"icon",className:"h-12 w-12 rounded-2xl text-emerald-600 bg-emerald-50/50 hover:bg-emerald-600 hover:text-white transition-all shadow-sm",onClick:()=>$(s),children:e.jsx(f,{className:"w-5 h-5"})}),e.jsx(r,{variant:"ghost",size:"icon",className:"h-12 w-12 rounded-2xl text-rose-500 bg-rose-50/50 hover:bg-rose-600 hover:text-white transition-all shadow-sm",onClick:()=>L(s.id),children:e.jsx(ee,{className:"w-5 h-5"})})]})]})]})})]},s.id))})}),e.jsx(O,{open:A,onOpenChange:c,children:e.jsxs(F,{className:"sm:max-w-2xl",children:[e.jsxs(P,{children:[e.jsxs(D,{className:"flex items-center gap-2 text-xl",children:[e.jsx(M,{className:"w-5 h-5 text-primary"}),"Odgovori korisniku"]}),e.jsx(E,{children:"Vaš odgovor bit će poslan direktno na email korisnika."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(n,{htmlFor:"to",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Primatelj"}),e.jsx(j,{id:"to",value:(a==null?void 0:a.email)||"",disabled:!0,className:"bg-gray-50 border-gray-200"})]}),e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(n,{htmlFor:"subject",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Predmet"}),e.jsx(j,{id:"subject",value:"Re: Vaša poruka za Dišpet",disabled:!0,className:"bg-gray-50 border-gray-200"})]}),e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(n,{htmlFor:"message",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Vaš Odgovor"}),e.jsx(T,{id:"message",value:b,onChange:s=>y(s.target.value),className:"min-h-[250px] font-normal leading-relaxed resize-none p-4",placeholder:"Napišite svoj odgovor ovdje..."})]})]}),e.jsxs(R,{className:"gap-2 sm:gap-0",children:[e.jsx(r,{variant:"outline",onClick:()=>c(!1),children:"Odustani"}),e.jsxs(r,{onClick:G,disabled:p,className:"pl-4 pr-6",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),p?"Slanje...":"Pošalji Odgovor"]})]})]})}),e.jsx(O,{open:H,onOpenChange:m,children:e.jsxs(F,{className:"sm:max-w-xl",children:[e.jsxs(P,{children:[e.jsxs(D,{className:"flex items-center gap-2 text-xl",children:[e.jsx(f,{className:"w-5 h-5 text-green-600"}),"Proslijedi poruku"]}),e.jsx(E,{children:"Proslijedite originalnu poruku trećoj strani."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(n,{htmlFor:"fwd-to",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Proslijedi na Email"}),e.jsx(j,{id:"fwd-to",placeholder:"ime@primjer.com",value:k,onChange:s=>V(s.target.value),className:"bg-white"})]}),e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(n,{htmlFor:"fwd-message",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Napomena (Opcionalno)"}),e.jsx(T,{id:"fwd-message",value:S,onChange:s=>C(s.target.value),className:"min-h-[120px] resize-none",placeholder:"Dodajte napomenu uz prosljeđenu poruku..."})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border text-sm text-gray-500",children:[e.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:"Originalna poruka:"}),e.jsxs("p",{className:"line-clamp-3 italic",children:['"',a==null?void 0:a.message,'"']})]})]}),e.jsxs(R,{className:"gap-2 sm:gap-0",children:[e.jsx(r,{variant:"outline",onClick:()=>m(!1),children:"Odustani"}),e.jsxs(r,{onClick:W,disabled:p,className:"bg-green-600 hover:bg-green-700 text-white pl-4 pr-6",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),p?"Slanje...":"Proslijedi"]})]})]})})]})})};export{xe as default};
