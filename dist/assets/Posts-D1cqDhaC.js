import{l as C,r as a,b as P,j as e,g as b,I as k,B as y,L as T,Q as F,T as _,V as E,W as M,Y as L,Z as w,a as D}from"./index-CSj38plj.js";import{u as I,c as B,g as q,d as z}from"./posts-BgcMLZGo.js";import{T as O}from"./textarea-CPlsg5z5.js";import{M as H}from"./MediaPicker-CsbJgEDt.js";import{R}from"./quill.snow-CyPk4ahj.js";import{B as U}from"./badge-Dnlq4UGp.js";import{P as A}from"./plus-BQV9TYb2.js";import{C as G}from"./calendar-kSwU8qJh.js";import{S as Q}from"./square-pen-BQZxOmB0.js";import{T as V}from"./trash-2-DLglMK3D.js";import"./check-B2G0Veot.js";import"./chevron-right-VIIZqnKR.js";import"./isEqual-CWDEtcn5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=C("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Y={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image","code-block"],["clean"]]},Z=["header","bold","italic","underline","strike","list","bullet","link","image","code-block"],$=({post:t,onSuccess:f})=>{const[x,i]=a.useState(""),[o,u]=a.useState(""),[d,c]=a.useState(""),[h,n]=a.useState(0),[j,s]=a.useState(""),[l,g]=a.useState(!1),{toast:m}=P();a.useEffect(()=>{var r,p;if(t){i(t.title.rendered),u(t.content.rendered);const v=t.excerpt.rendered.replace(/<[^>]*>?/gm,"").replace(/&nbsp;/g," ").replace(/&hellip;/g,"...").trim();c(v),n(t.featured_media);const N=(p=(r=t._embedded)==null?void 0:r["wp:featuredmedia"])==null?void 0:p[0];N&&s(N.source_url)}else i(""),u(""),c(""),n(0),s("")},[t]);const S=async r=>{r.preventDefault(),g(!0);const p={title:x,content:o,excerpt:d,status:"publish",featured_media:h>0?h:void 0};try{t?(await I(t.id,p),m({title:"Success",description:"Post updated successfully"})):(await B(p),m({title:"Success",description:"Post created successfully"})),f()}catch(v){console.error("Post save error:",v),m({title:"Error",description:"Failed to save post. Check permissions.",variant:"destructive"})}finally{g(!1)}};return e.jsx("form",{onSubmit:S,className:"flex flex-col gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"title",className:"text-sm font-semibold text-gray-700",children:"Post Title"}),e.jsx(k,{id:"title",value:x,onChange:r=>i(r.target.value),placeholder:"e.g. 5 Tips for Outdoor Training",required:!0,className:"text-lg font-medium py-6 border-gray-200 focus:border-primary focus:ring-primary/20 transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"content",className:"text-sm font-semibold text-gray-700",children:"Body Content"}),e.jsx("div",{className:"min-h-[400px] mb-14 lg:mb-12 border rounded-lg border-gray-200 overflow-hidden bg-white shadow-sm transition-all focus-within:ring-2 focus-within:ring-primary/10",children:e.jsx(R,{theme:"snow",value:o,onChange:u,modules:Y,formats:Z,className:"h-full border-0"})})]})]}),e.jsxs("div",{className:"space-y-8 lg:border-l lg:pl-8 border-gray-100 pb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(b,{className:"text-sm font-semibold text-gray-700 uppercase tracking-wider",children:"Featured Image"})}),e.jsx("div",{className:"bg-gray-50/50 p-4 rounded-xl border border-dashed border-gray-300 transition-colors hover:bg-gray-50",children:e.jsx(H,{value:j,onChange:s,onSelectMedia:r=>n(r.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(b,{htmlFor:"excerpt",className:"text-sm font-semibold text-gray-700 uppercase tracking-wider text-xs",children:"Excerpt / Summary"}),e.jsx(O,{id:"excerpt",value:d,onChange:r=>c(r.target.value),placeholder:"A brief summary for cards and search engines...",className:"min-h-[120px] resize-none border-gray-200 bg-white shadow-sm focus:border-primary focus:ring-primary/20"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Short summary displayed on the blog listing page."})]}),e.jsx("div",{className:"pt-4 sticky bottom-0 bg-white/80 backdrop-blur-sm",children:e.jsx(y,{type:"submit",disabled:l,className:"w-full py-6 text-base font-bold shadow-lg shadow-primary/20 hover:scale-[1.02] active:scale-[0.98] transition-all",children:l?e.jsx(T,{className:"w-5 h-5 animate-spin mr-2"}):t?"Update & Sync Post":"Publish New Post"})})]})]})})},ne=()=>{const[t,f]=a.useState([]),[x,i]=a.useState(!0),{toast:o}=P(),[u,d]=a.useState(!1),[c,h]=a.useState(null),n=async()=>{i(!0);try{const s=await q(1,100);f(s)}catch(s){console.error("Failed to fetch posts:",s),o({title:"Error",description:"Failed to load posts.",variant:"destructive"})}finally{i(!1)}};a.useEffect(()=>{n()},[]);const j=async s=>{if(confirm("Are you sure you want to delete this post?"))try{await z(s),f(t.filter(l=>l.id!==s)),o({title:"Success",description:"Post deleted successfully"})}catch{o({title:"Error",description:"Failed to delete post",variant:"destructive"})}};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-in fade-in duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold font-heading bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Blog Posts"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-lg",children:"Create, edit, and manage your blog content."})]}),e.jsxs(F,{open:u,onOpenChange:d,children:[e.jsx(_,{asChild:!0,children:e.jsxs(y,{onClick:()=>h(null),className:"shadow-lg hover:shadow-xl transition-all",children:[e.jsx(A,{className:"w-4 h-4 mr-2"})," New Post"]})}),e.jsxs(E,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(M,{children:e.jsx(L,{className:"text-2xl font-heading",children:c?"Edit Post":"Create New Post"})}),e.jsx($,{post:c,onSuccess:()=>{d(!1),n()}})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[x?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-pulse",children:[e.jsx(w,{className:"w-12 h-12 text-gray-200 mb-4"}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Loading posts..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>{var l,g,m;return e.jsxs(D,{className:"group hover:shadow-lg transition-all border-border/60 flex flex-col overflow-hidden",children:[((m=(g=(l=s._embedded)==null?void 0:l["wp:featuredmedia"])==null?void 0:g[0])==null?void 0:m.source_url)&&e.jsxs("div",{className:"h-48 w-full bg-gray-100 overflow-hidden relative",children:[e.jsx("img",{src:s._embedded["wp:featuredmedia"][0].source_url,alt:"Featured",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(U,{className:"bg-white/90 text-black hover:bg-white border-0 shadow-sm",children:"Published"})})]}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-3",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),new Date(s.date).toLocaleDateString()]}),e.jsx("h3",{className:"text-xl font-bold mb-3 line-clamp-2 group-hover:text-primary transition-colors",dangerouslySetInnerHTML:{__html:s.title.rendered}}),e.jsx("div",{className:"text-muted-foreground text-sm line-clamp-3 mb-6 flex-1",dangerouslySetInnerHTML:{__html:s.excerpt.rendered}}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100 mt-auto",children:[e.jsxs("a",{href:`https://wp.dispet.fun/${s.slug}`,target:"_blank",rel:"noreferrer",className:"text-xs font-medium text-gray-500 hover:text-primary flex items-center gap-1",children:[e.jsx(W,{className:"w-3 h-3"})," View Live"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{h(s),d(!0)},children:e.jsx(Q,{className:"w-4 h-4 text-blue-600"})}),e.jsx(y,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-red-50",onClick:()=>j(s.id),children:e.jsx(V,{className:"w-4 h-4 text-red-600"})})]})]})]})]},s.id)})}),!x&&t.length===0&&e.jsxs("div",{className:"text-center py-20 bg-white rounded-lg border border-dashed col-span-full",children:[e.jsx(w,{className:"w-16 h-16 text-gray-200 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No posts yet"}),e.jsx("p",{className:"text-muted-foreground max-w-sm mx-auto mt-2",children:"Start writing your blog by creating your first post."})]})]})]})};export{ne as default};
