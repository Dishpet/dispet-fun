import{_ as te,a as le,b as ae,c as ie,d as re,e as ne,f as oe,g as ce,h as de,i as ge,j as xe,y as me,z as he,A as _e,B as ue,C as pe,k as fe,l as be,m as ve,n as je,o as Ne,p as Ce,q as we,r as ke,s as ye,t as Se,u as Le,v as ze,w as Ae,x as De}from"./logo-9-DeVPud_4.js";import{l as V,r as x,b as Re,j as e,L as B,B as c,a as N,F as C,J as w,K as k,g as d,I as O,aq as Te,X as y}from"./index-D6EageyD.js";import{S as I,W as Ee}from"./switch-CN6zqHDC.js";import{T as Pe,a as Be,b as S,c as Oe}from"./tabs-Cd5GcXz7.js";import{R as Ie}from"./refresh-ccw-DIswJQuU.js";import{S as $e}from"./save-C9GKW46-.js";import{P as $}from"./palette-DLQry0RW.js";import{C as Fe}from"./clock-DfKhAXZN.js";import{C as Ge}from"./check-DMWmpvTH.js";import{P as Ve}from"./plus-BCzvxdBk.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=V("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=V("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),F="/api",Ke=Object.assign({"/src/assets/design-collections/street/street-1.png":te,"/src/assets/design-collections/street/street-10.png":le,"/src/assets/design-collections/street/street-2.png":ae,"/src/assets/design-collections/street/street-3-alt.png":ie,"/src/assets/design-collections/street/street-3.png":re,"/src/assets/design-collections/street/street-4.png":ne,"/src/assets/design-collections/street/street-5.png":oe,"/src/assets/design-collections/street/street-6.png":ce,"/src/assets/design-collections/street/street-7.png":de,"/src/assets/design-collections/street/street-8.png":ge,"/src/assets/design-collections/street/street-9.png":xe}),Me=Object.assign({"/src/assets/design-collections/vintage/vintage-1.png":me,"/src/assets/design-collections/vintage/vintage-2.png":he,"/src/assets/design-collections/vintage/vintage-3.png":_e,"/src/assets/design-collections/vintage/vintage-4.png":ue,"/src/assets/design-collections/vintage/vintage-5.png":pe}),Ue=Object.assign({"/src/assets/design-collections/logo/KIDS-BADGE.png":fe,"/src/assets/design-collections/logo/STREET-BADGE.png":be,"/src/assets/design-collections/logo/VINTAGE-BADGE.png":ve,"/src/assets/design-collections/logo/logo-1.png":je,"/src/assets/design-collections/logo/logo-10.png":Ne,"/src/assets/design-collections/logo/logo-11.png":Ce,"/src/assets/design-collections/logo/logo-12.png":we,"/src/assets/design-collections/logo/logo-3.png":ke,"/src/assets/design-collections/logo/logo-4.png":ye,"/src/assets/design-collections/logo/logo-5.png":Se,"/src/assets/design-collections/logo/logo-6.png":Le,"/src/assets/design-collections/logo/logo-7.png":ze,"/src/assets/design-collections/logo/logo-8.png":Ae,"/src/assets/design-collections/logo/logo-9.png":De}),L=p=>Object.entries(p).map(([u,f])=>({path:u,url:f,filename:u.split("/").pop()||""})),G={Street:L(Ke),Vintage:L(Me),Logo:L(Ue)},_=[{name:"Crna",hex:"#231f20"},{name:"Siva",hex:"#d1d5db"},{name:"Tirkizna",hex:"#00ab98"},{name:"Cijan",hex:"#00aeef"},{name:"Plava",hex:"#387bbf"},{name:"Ljubičasta",hex:"#8358a4"},{name:"Bijela",hex:"#ffffff"},{name:"Roza",hex:"#e78fab"},{name:"Mint",hex:"#a1d7c0"}],z={tshirt:"T-Shirt",hoodie:"Hoodie",cap:"Cap",bottle:"Bottle"},as=()=>{const[p,u]=x.useState(!0),[f,A]=x.useState(!1),[l,m]=x.useState(null),[g,q]=x.useState("tshirt"),[v,W]=x.useState("Street"),[r,D]=x.useState(null),[R,K]=x.useState("#231f20"),{toast:b}=Re();x.useEffect(()=>{j()},[]);const j=async()=>{u(!0);try{const s=await fetch(`${F}/antigravity/v1/shop-config`);if(!s.ok)throw new Error("Failed to fetch config");const t=await s.json();m(t)}catch(s){console.error("Failed to fetch shop config:",s),b({title:"Error",description:"Failed to load configuration",variant:"destructive"})}finally{u(!1)}},M=async()=>{if(l){A(!0);try{const s=localStorage.getItem("wp_token"),t=await fetch(`${F}/antigravity/v1/shop-config`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(l)});if(!t.ok){const a=await t.json();throw new Error(a.message||"Failed to save")}b({title:"Saved!",description:"Shop configuration updated successfully."})}catch(s){console.error("Failed to save shop config:",s),b({title:"Error",description:s.message||"Failed to save configuration",variant:"destructive"})}finally{A(!1)}}},U=s=>{if(!l)return;const t=l[g],a=t.allowed_colors.includes(s);m({...l,[g]:{...t,allowed_colors:a?t.allowed_colors.filter(i=>i!==s):[...t.allowed_colors,s]}})},Z=(s,t)=>{if(!l)return;const a=l.design_color_map[s]||_.map(o=>o.hex),i=a.includes(t);m({...l,design_color_map:{...l.design_color_map,[s]:i?a.filter(o=>o!==t):[...a,t]}})},J=s=>{if(!l)return;const t=l[g],a=t.restricted_designs.includes(s);m({...l,[g]:{...t,restricted_designs:a?t.restricted_designs.filter(i=>i!==s):[...t.restricted_designs,s]}})},h=(s,t)=>{l&&m({...l,[g]:{...l[g],[s]:t}})},X=()=>{if(!l||!r)return;if(l.alternatives.find(t=>t.design_id===r)){b({title:"Already exists",description:"This design already has an alternative rule."});return}m({...l,alternatives:[...l.alternatives,{design_id:r,trigger_colors:[],replace_with:""}]})},T=(s,t,a)=>{l&&m({...l,alternatives:l.alternatives.map(i=>i.design_id===s?{...i,[t]:a}:i)})},Q=(s,t)=>{if(!l)return;const a=l.alternatives.find(o=>o.design_id===s);if(!a)return;const i=a.trigger_colors.includes(t);T(s,"trigger_colors",i?a.trigger_colors.filter(o=>o!==t):[...a.trigger_colors,t])},Y=s=>{l&&m({...l,alternatives:l.alternatives.filter(t=>t.design_id!==s)})},H=x.useMemo(()=>G[v],[v]),ee=s=>l?l.design_color_map[s]||_.map(t=>t.hex):_.map(t=>t.hex),E=s=>l?l[g].restricted_designs.includes(s):!1,P=s=>l&&l.alternatives.find(t=>t.design_id===s)||null;if(p)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(B,{className:"w-8 h-8 animate-spin text-primary"})});if(!l)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[e.jsx("p",{className:"text-slate-500",children:"Failed to load configuration."}),e.jsx(c,{onClick:j,children:"Retry"})]});const n=l[g];return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-slate-200/60 pb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl md:text-4xl font-black font-heading text-slate-900 tracking-tight uppercase",children:"Shop Rules"}),e.jsx("p",{className:"text-slate-500 text-sm md:text-lg font-medium mt-1",children:"Configure colors, designs, and cycle logic per product."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",onClick:j,disabled:p,children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"})," Refresh"]}),e.jsxs(c,{onClick:M,disabled:f,children:[f?e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx($e,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["tshirt","hoodie","cap","bottle"].map(s=>e.jsx(c,{variant:g===s?"default":"outline",onClick:()=>q(s),className:"font-bold",children:z[s]},s))}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(N,{className:"rounded-2xl border-slate-100 shadow-lg lg:col-span-1",children:[e.jsx(C,{className:"pb-4 border-b border-slate-100",children:e.jsxs(w,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5 text-blue-500"}),z[g]," Settings"]})}),e.jsxs(k,{className:"pt-4 space-y-5",children:[e.jsxs("div",{children:[e.jsxs(d,{className:"text-sm font-semibold text-slate-700 flex items-center gap-2 mb-2",children:[e.jsx($,{className:"w-4 h-4"})," Product Colors"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(s=>{const t=n.allowed_colors.includes(s.hex);return e.jsx("button",{onClick:()=>U(s.hex),className:`w-7 h-7 rounded-full border-2 transition-all ${t?"border-blue-500 ring-2 ring-blue-200":"border-slate-300 opacity-40"}`,style:{backgroundColor:s.hex},title:s.name},s.hex)})})]}),n.has_front_back&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Default Zone"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:n.default_zone==="front"?"default":"outline",size:"sm",onClick:()=>h("default_zone","front"),children:"Front"}),e.jsx(c,{variant:n.default_zone==="back"?"default":"outline",size:"sm",onClick:()=>h("default_zone","back"),children:"Back"})]})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Locked Zone"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:n.locked_zone==="front"?"default":"outline",size:"sm",onClick:()=>h("locked_zone","front"),children:"Front"}),e.jsx(c,{variant:n.locked_zone==="back"?"default":"outline",size:"sm",onClick:()=>h("locked_zone","back"),children:"Back"}),e.jsx(c,{variant:n.locked_zone===null?"default":"outline",size:"sm",onClick:()=>h("locked_zone",null),children:"None"})]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-100",children:[e.jsxs(d,{className:"text-sm font-semibold text-slate-700 flex items-center gap-2 mb-3",children:[e.jsx(Fe,{className:"w-4 h-4"})," Cycle Logic"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Enable Cycle"}),e.jsx(I,{checked:n.cycle_enabled??!0,onCheckedChange:s=>h("cycle_enabled",s)})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-xs text-slate-500",children:"Duration (ms)"}),e.jsx(O,{type:"number",value:n.cycle_duration??6e3,onChange:s=>h("cycle_duration",parseInt(s.target.value)||6e3),className:"mt-1"})]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-100",children:[e.jsxs(d,{className:"text-sm font-semibold text-slate-700 flex items-center gap-2 mb-2",children:[e.jsx(qe,{className:"w-4 h-4"})," Restricted (",n.restricted_designs.length,")"]}),e.jsx("p",{className:"text-xs text-slate-400",children:n.restricted_designs.length>0?n.restricted_designs.join(", "):"None - manage in Collections →"})]})]})]}),e.jsxs(N,{className:"rounded-2xl border-slate-100 shadow-lg lg:col-span-2",children:[e.jsx(C,{className:"pb-4 border-b border-slate-100",children:e.jsxs(w,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5 text-purple-500"}),"Collections Manager"]})}),e.jsxs(k,{className:"pt-4",children:[e.jsxs(Pe,{value:v,onValueChange:s=>W(s),children:[e.jsxs(Be,{className:"mb-4",children:[e.jsx(S,{value:"Street",children:"Street"}),e.jsx(S,{value:"Vintage",children:"Vintage"}),e.jsx(S,{value:"Logo",children:"Logo"})]}),["Street","Vintage","Logo"].map(s=>e.jsx(Oe,{value:s,className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:G[s].map(t=>{const a=E(t.filename),i=P(t.filename),o=r===t.filename;return e.jsxs("div",{onClick:()=>D(o?null:t.filename),className:`relative rounded-xl overflow-hidden border-2 cursor-pointer transition-all ${o?"border-blue-500 ring-2 ring-blue-200":a?"border-red-300 opacity-60":"border-slate-200 hover:border-slate-400"}`,children:[e.jsx("div",{className:"aspect-square flex items-center justify-center p-2",style:{backgroundColor:R},children:e.jsx("img",{src:t.url,alt:t.filename,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"absolute top-1 right-1 flex gap-1",children:[a&&e.jsx("span",{className:"bg-red-500 text-white text-[9px] px-1.5 py-0.5 rounded-full font-bold",children:"BLOCKED"}),i&&e.jsx("span",{className:"bg-purple-500 text-white text-[9px] px-1.5 py-0.5 rounded-full font-bold",children:"ALT"})]}),e.jsx("div",{className:"bg-white/90 backdrop-blur-sm px-2 py-1 text-[10px] font-mono text-slate-600 truncate",children:t.filename})]},t.filename)})})},s))]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex items-center gap-3",children:[e.jsx(d,{className:"text-sm font-semibold text-slate-700",children:"Preview Color:"}),e.jsx("div",{className:"flex gap-1",children:_.map(s=>e.jsx("button",{onClick:()=>K(s.hex),className:`w-6 h-6 rounded-full border transition-all ${R===s.hex?"ring-2 ring-blue-400 border-blue-500":"border-slate-300"}`,style:{backgroundColor:s.hex},title:s.name},s.hex))})]})]})]})]}),r&&e.jsxs(N,{className:"rounded-2xl border-blue-200 shadow-lg bg-blue-50/30",children:[e.jsxs(C,{className:"pb-4 border-b border-blue-100 flex flex-row items-center justify-between",children:[e.jsxs(w,{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-blue-500"}),r]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>D(null),children:e.jsx(y,{className:"w-4 h-4"})})]}),e.jsx(k,{className:"pt-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-sm font-semibold text-slate-700 mb-2 block",children:"Live Preview"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:_.filter(s=>n.allowed_colors.includes(s.hex)).map(s=>{var o;const a=ee(r).includes(s.hex),i=(o=H.find(se=>se.filename===r))==null?void 0:o.url;return e.jsx("div",{onClick:()=>Z(r,s.hex),className:`aspect-square rounded-lg overflow-hidden cursor-pointer border-2 transition-all ${a?"border-green-500 ring-1 ring-green-300":"border-red-300 opacity-50"}`,style:{backgroundColor:s.hex},title:`Click to ${a?"disable":"enable"} ${s.name}`,children:e.jsxs("div",{className:"w-full h-full flex items-center justify-center p-2 relative",children:[i&&e.jsx("img",{src:i,alt:"",className:"max-w-full max-h-full object-contain"}),e.jsx("div",{className:"absolute top-1 right-1",children:a?e.jsx(Ge,{className:"w-4 h-4 text-green-600 bg-white rounded-full p-0.5"}):e.jsx(y,{className:"w-4 h-4 text-red-600 bg-white rounded-full p-0.5"})})]})},s.hex)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-slate-200",children:[e.jsxs("div",{children:[e.jsxs(d,{className:"font-semibold text-slate-700",children:["Restrict for ",z[g]]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Hide this design from this product"})]}),e.jsx(I,{checked:E(r),onCheckedChange:()=>J(r)})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border border-slate-200",children:[e.jsxs(d,{className:"font-semibold text-slate-700 flex items-center gap-2 mb-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-purple-500"})," Alternative Design"]}),(()=>{const s=P(r);return s?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(d,{className:"text-xs text-slate-500",children:"Trigger Colors (click to toggle)"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:_.map(t=>{const a=s.trigger_colors.includes(t.hex);return e.jsx("button",{onClick:()=>Q(r,t.hex),className:`w-6 h-6 rounded-full border-2 transition-all ${a?"border-purple-500 ring-2 ring-purple-200":"border-slate-300 opacity-50"}`,style:{backgroundColor:t.hex},title:t.name},t.hex)})})]}),e.jsxs("div",{children:[e.jsx(d,{className:"text-xs text-slate-500",children:"Replace With (filename)"}),e.jsx(O,{value:s.replace_with,onChange:t=>T(r,"replace_with",t.target.value),placeholder:"e.g. street-3-alt.png",className:"mt-1"})]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:()=>Y(r),children:[e.jsx(y,{className:"w-4 h-4 mr-1"})," Remove Rule"]})]}):e.jsxs(c,{variant:"outline",size:"sm",onClick:X,children:[e.jsx(Ve,{className:"w-4 h-4 mr-1"})," Add Alternative Rule"]})})()]})]})]})})]})]})};export{as as default};
