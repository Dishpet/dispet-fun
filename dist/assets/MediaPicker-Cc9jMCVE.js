import{l as U,aw as C,V as A,r as h,b as z,j as e,B as x,L as k,n as E,C as L,aq as T,X as P}from"./index-DXSB3iCr.js";import{C as D,a as F}from"./collapsible-Df5tmwoV.js";import{C as R}from"./check-BqakKy6B.js";import{C as S}from"./chevron-right-CKKHeXOG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=U("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),B=async(a=1,r=20)=>{const d=`/wp/v2/media?page=${a}&per_page=${r}`,i=await fetch(`${C}${d}`,{headers:{...A()}});if(!i.ok)throw new Error(`WordPress API Error: ${i.statusText}`);const n=parseInt(i.headers.get("X-WP-TotalPages")||"1",10);return{data:await i.json(),totalPages:n}},H=async a=>{const r=A();new FormData().append("file",a);const i=`${C}/wp/v2/media`,n=r.Authorization,c=await fetch(i,{method:"POST",headers:{Authorization:n,"Content-Disposition":`attachment; filename="${a.name}"`,"Content-Type":a.type},body:a});if(!c.ok)throw new Error(`Media Upload Error: ${c.statusText}`);return c.json()},O=24,W=({onSelect:a,multiSelect:r=!1})=>{const[d,i]=h.useState([]),[n,c]=h.useState(!0),[f,b]=h.useState(!1),[l,m]=h.useState([]),[o,j]=h.useState(1),[g,w]=h.useState(1),{toast:y}=z();h.useEffect(()=>{_(o)},[o]);const _=async s=>{c(!0);try{const{data:t,totalPages:p}=await B(s,O);i(t),w(p)}catch(t){console.error(t),y({title:"Error",description:"Failed to load media",variant:"destructive"})}finally{c(!1)}},v=()=>{o<g&&j(s=>s+1)},$=()=>{o>1&&j(s=>s-1)},I=async s=>{if(!s.target.files||s.target.files.length===0)return;const t=s.target.files[0];b(!0);try{const p=await H(t);i([p,...d]),y({title:"Success",description:"Image uploaded successfully"})}catch(p){console.error(p),y({title:"Error",description:"Upload failed",variant:"destructive"})}finally{b(!1)}},M=s=>{let t;r?l.some(u=>u.id===s.id)?t=l.filter(u=>u.id!==s.id):t=[...l,s]:t=[s],m(t),a&&a(r?t:t[0])},N=s=>l.some(t=>t.id===s);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-400 tracking-[0.2em] ml-1",children:"Media Library"}),e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-auto justify-between sm:justify-end",children:[e.jsx("span",{className:"text-sm text-gray-500 mr-2",children:l.length>0?`${l.length} selected`:""}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/*",id:"media-upload",className:"hidden",onChange:I,disabled:f}),e.jsx("label",{htmlFor:"media-upload",children:e.jsx(x,{variant:"outline",size:"sm",className:"cursor-pointer rounded-full h-10 px-6 font-bold text-xs uppercase tracking-wider",asChild:!0,disabled:f,children:e.jsxs("span",{children:[f?e.jsx(k,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(q,{className:"w-4 h-4 mr-2"}),"Upload"]})})})]})]})]}),e.jsx("div",{className:"bg-slate-50 border-none rounded-[2rem] p-4 md:p-6 min-h-[300px] md:min-h-[400px] flex flex-col shadow-inner",children:n?e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-[300px]",children:e.jsx(k,{className:"w-8 h-8 animate-spin text-gray-400"})}):e.jsxs(e.Fragment,{children:[d.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-4",children:d.map(s=>{var t,p,u;return e.jsxs("div",{className:E("relative aspect-square rounded-2xl overflow-hidden border-2 cursor-pointer transition-all group bg-white shadow-sm",N(s.id)?"border-primary ring-2 ring-primary/20":"border-transparent hover:border-gray-300"),onClick:()=>M(s),children:[e.jsx("img",{src:((u=(p=(t=s.media_details)==null?void 0:t.sizes)==null?void 0:p.thumbnail)==null?void 0:u.source_url)||s.source_url,alt:s.title.rendered,className:"w-full h-full object-cover"}),N(s.id)&&e.jsx("div",{className:"absolute inset-0 bg-primary/20 flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-full p-1",children:e.jsx(R,{className:"w-4 h-4 text-primary"})})})]},s.id)})}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:"No media found on this page."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center pt-4 border-t border-gray-200 mt-auto gap-4 sm:gap-0",children:[e.jsxs("div",{className:"flex justify-between w-full sm:w-auto gap-2",children:[e.jsxs(x,{variant:"ghost",size:"sm",className:"rounded-full h-10 px-4 md:px-6 font-bold text-xs uppercase tracking-wider bg-white shadow-sm hover:bg-slate-100 flex-1 sm:flex-none",onClick:$,disabled:o<=1||n,children:[e.jsx(L,{className:"w-4 h-4 mr-1"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Prethodna"})]}),e.jsxs(x,{variant:"ghost",size:"sm",className:"sm:hidden rounded-full h-10 px-4 font-bold text-xs uppercase tracking-wider bg-white shadow-sm hover:bg-slate-100 flex-1",onClick:v,disabled:o>=g||n,children:["Sljedeća ",e.jsx(S,{className:"w-4 h-4 ml-1"})]})]}),e.jsxs("span",{className:"text-sm text-gray-500 font-medium",children:["Page ",o," / ",g||1]}),e.jsxs(x,{variant:"ghost",size:"sm",className:"hidden sm:flex rounded-full h-10 px-6 font-bold text-xs uppercase tracking-wider bg-white shadow-sm hover:bg-slate-100",onClick:v,disabled:o>=g||n,children:["Sljedeća ",e.jsx(S,{className:"w-4 h-4 ml-1"})]})]})]})})]})},J=({value:a,onChange:r,onSelectMedia:d,multiple:i=!1})=>{const[n,c]=h.useState(!1),f=l=>{if(i){const m=Array.isArray(l)?l:[l];r&&r(m.map(o=>o.source_url)),d&&d(m)}else{const m=l;r&&r(m.source_url),d&&d(m),c(!1)}},b=()=>a?Array.isArray(a)?a.length===0?null:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:a.map((l,m)=>e.jsxs("div",{className:"relative aspect-square bg-gray-100 rounded-lg overflow-hidden border border-gray-200 group",children:[e.jsx("img",{src:l,alt:`Selected ${m}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:o=>{o.preventDefault();const j=a.filter((g,w)=>w!==m);r&&r(j)},children:e.jsx(P,{className:"w-3 h-3"})})]},m))}):e.jsxs("div",{className:"relative w-full h-48 bg-gray-100 rounded-lg overflow-hidden border border-gray-200 group",children:[e.jsx("img",{src:a,alt:"Selected",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:l=>{l.preventDefault(),r&&r("")},children:e.jsx(P,{className:"w-4 h-4"})})]}):null;return e.jsxs("div",{className:"space-y-4",children:[b(),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(x,{variant:"outline",type:"button",onClick:()=>c(!n),className:E("w-full h-12 rounded-xl font-bold text-xs uppercase tracking-wider border-slate-200 transition-all",n?"bg-slate-100":"hover:bg-slate-50"),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),n?"Zatvori Galeriju":a&&(Array.isArray(a)?a.length>0:a)?"Promijeni Sliku":"Odaberi Sliku"]}),e.jsx(D,{open:n,children:e.jsx(F,{children:e.jsxs("div",{className:"bg-slate-50 p-4 rounded-2xl border border-slate-200 mt-2 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-slate-400 tracking-[0.2em]",children:"Medijska Biblioteka"}),i&&e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>c(!1),className:"h-8 rounded-lg font-bold text-[10px] uppercase tracking-wider text-primary",children:"Završi odabir"})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto pr-2 custom-scrollbar",children:e.jsx(W,{onSelect:f,multiSelect:i})})]})})})]})]})};export{J as M,q as U};
