import{r as l,b as k,j as e,B as c,L as u,g as T,I as h,x as z}from"./index-CSj38plj.js";import{a as M,u as O,c as _}from"./posts-BgcMLZGo.js";import{S as B}from"./save-E33O0gIw.js";import{M as I}from"./map-pin-O9RZOBRU.js";import{M as J}from"./mail-CBZRhkrs.js";import{P as v}from"./plus-BQV9TYb2.js";import{T as N}from"./trash-2-DLglMK3D.js";const b="config-contact",d={location:"Split, Croatia",emails:["info@dispet.fun"],phones:["(+385) 555 6666"]};function Q(){const[p,x]=l.useState(null),[i,n]=l.useState(d),[f,m]=l.useState(!0),[g,j]=l.useState(!1),{toast:r}=k();l.useEffect(()=>{y()},[]);const y=async()=>{m(!0);try{const a=await M(b,!0);if(a){x(a);try{const s=a.content.rendered.replace(/<[^>]*>?/gm,""),t=JSON.parse(s);if(t&&typeof t=="object"){const o=t.emails||(t.email?[t.email]:d.emails),L=t.phones||(t.phone?[t.phone]:d.phones);n({location:t.location||d.location,emails:o,phones:L}),m(!1);return}}catch(s){console.error("Failed to parse contact config",s)}}}catch(a){console.error(a),r({title:"Error",description:"Failed to load configuration",variant:"destructive"})}finally{m(!1)}},w=async()=>{j(!0);const a=JSON.stringify(i);try{if(p)await O(p.id,{content:a,status:"publish"}),r({title:"Saved",description:"Contact info updated."});else{const s=await _({title:"System Config: Contact",content:a,slug:b,status:"publish"});x(s),r({title:"Created",description:"Configuration initialized."})}}catch(s){console.error(s),r({title:"Error",description:"Failed to save configuration",variant:"destructive"})}finally{j(!1)}},C=()=>n({...i,emails:[...i.emails,""]}),S=a=>{const s=i.emails.filter((t,o)=>o!==a);n({...i,emails:s})},P=(a,s)=>{const t=[...i.emails];t[a]=s,n({...i,emails:t})},E=()=>n({...i,phones:[...i.phones,""]}),A=a=>{const s=i.phones.filter((t,o)=>o!==a);n({...i,phones:s})},F=(a,s)=>{const t=[...i.phones];t[a]=s,n({...i,phones:t})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Contact Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage contact information displayed on the website."})]}),e.jsxs(c,{onClick:w,disabled:f||g,children:[g?e.jsx(u,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(B,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]}),f?e.jsx("div",{className:"py-20 flex justify-center",children:e.jsx(u,{className:"w-8 h-8 animate-spin text-gray-400"})}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl",children:[e.jsxs("div",{className:"space-y-4 p-6 border rounded-xl bg-white shadow-sm h-fit",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(I,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"location",children:"Address / City"}),e.jsx(h,{id:"location",value:i.location,onChange:a=>n({...i,location:a.target.value}),placeholder:"e.g. Split, Croatia"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Fixed to one location."})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4 p-6 border rounded-xl bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Email Addresses"})]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:C,children:[e.jsx(v,{className:"w-4 h-4 mr-1"})," Add"]})]}),e.jsx("div",{className:"space-y-3",children:i.emails.map((a,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{value:a,onChange:t=>P(s,t.target.value),placeholder:"info@example.com"}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>S(s),disabled:i.emails.length===1,children:e.jsx(N,{className:"w-4 h-4 text-red-500"})})]},s))})]}),e.jsxs("div",{className:"space-y-4 p-6 border rounded-xl bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Phone Numbers"})]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:E,children:[e.jsx(v,{className:"w-4 h-4 mr-1"})," Add"]})]}),e.jsx("div",{className:"space-y-3",children:i.phones.map((a,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{value:a,onChange:t=>F(s,t.target.value),placeholder:"+385 00 000 000"}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>A(s),disabled:i.phones.length===1,children:e.jsx(N,{className:"w-4 h-4 text-red-500"})})]},s))})]})]})]})]})}export{Q as default};
