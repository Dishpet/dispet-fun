import{u as j,b as v,a as y,r as u,j as s,f as p,I as g,B as w,L as b,G as N,g as _,y as k,z as C}from"./index-BRjihD9z.js";import{C as G}from"./card-C2vyyPm4.js";import{P as L}from"./PageHero-_m-cwe4E.js";import"./clouds-top-B3AemNNE.js";const S=()=>{const o=j(),{login:l}=v(),{toast:r}=y(),[c,d]=u.useState(!1),[n,x]=u.useState({username:"",password:""}),m=i=>{const{id:e,value:a}=i.target;x(t=>({...t,[e]:a}))},h=async i=>{try{const e=_(i.credential);console.log("Google User:",e);const a={id:Date.now(),username:e.email.split("@")[0],email:e.email,first_name:e.given_name,last_name:e.family_name,billing:{first_name:e.given_name,last_name:e.family_name,email:e.email,address_1:"",city:"",postcode:"",country:"",phone:""},shipping:{first_name:e.given_name,last_name:e.family_name,address_1:"",city:"",postcode:"",country:""}};l("google-session-token",a),r({title:"Uspješna Google prijava",description:`Dobrodošli, ${e.name}!`}),o("/account")}catch(e){console.error("Google Login Error",e),r({title:"Greška",description:"Neuspješna prijava putem Google-a.",variant:"destructive"})}},f=async i=>{i.preventDefault(),d(!0);try{const e=await k(n.username,n.password);if(e&&e.id){let a=e;try{const t=await C(e.id);t&&(a={...e,...t})}catch(t){console.warn("Failed to fetch WC customer details, using basic WP user",t)}l("basic-auth-session",a),r({title:"Uspješna prijava",description:`Dobrodošli natrag, ${a.first_name||a.username}!`}),o("/account")}else throw new Error("Invalid response")}catch(e){console.error("Login Check Failed:",e),r({title:"Greška pri prijavi",description:"Netočno korisničko ime ili lozinka.",variant:"destructive"})}finally{d(!1)}};return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(L,{title:"Prijava"}),s.jsx("div",{className:"container px-4 py-12 flex justify-center",children:s.jsxs(G,{className:"w-full max-w-md p-6 shadow-xl",children:[s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"username",children:"Korisničko ime ili Email"}),s.jsx(g,{id:"username",required:!0,value:n.username,onChange:m})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"password",children:"Lozinka"}),s.jsx(g,{id:"password",type:"password",required:!0,value:n.password,onChange:m})]}),s.jsx(w,{type:"submit",className:"w-full bg-gradient-to-r from-[#0044bf] to-[#ad00e9] text-white font-bold",disabled:c,children:c?s.jsx(b,{className:"w-4 h-4 animate-spin mr-2"}):"Prijavi se"}),s.jsxs("div",{className:"relative my-4",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("span",{className:"w-full border-t"})}),s.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:s.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Ili nastavite putem"})})]}),s.jsx("div",{className:"flex justify-center w-full",children:s.jsx(N,{onSuccess:h,onError:()=>{console.log("Login Failed"),r({title:"Greška",description:"Neuspješna prijava putem Google-a.",variant:"destructive"})},useOneTap:!0,theme:"filled_blue",shape:"pill",width:"300"})})]}),s.jsxs("p",{className:"text-center text-sm text-gray-500 mt-4",children:["Nemate račun? ",s.jsx("span",{className:"text-primary font-bold",children:"Pridružite se klikom na gumb u izborniku!"})]})]})})]})};export{S as default};
