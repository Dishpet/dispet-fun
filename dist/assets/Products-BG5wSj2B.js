import{l as I,r as c,b as L,j as e,a as D,F as B,J as O,Z as R,K as q,B as f,L as S,_ as V,$ as w,u as $,O as M,Q as U,T as Z,I as k,n as J,s as Q,a0 as H,a1 as K,a2 as W}from"./index-BKHBW7nG.js";import{B as X}from"./badge-VGBY9r7f.js";import{C as G,a as Y,b as ee,c as te}from"./collapsible-D0KLMt6K.js";import{R as se}from"./refresh-cw-DW34DT4M.js";import{P as ae}from"./plus-Cf8f21gh.js";import{P as C}from"./package-BIJOmUgN.js";import{S as re}from"./square-pen-uZfllxpy.js";import{T as ie}from"./trash-2-C05tmBfp.js";import{S as oe}from"./save-C3bmp4kE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=I("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ne=[{name:"Veličina",slug:"pa_size",type:"select",order_by:"menu_order",has_archives:!1,terms:["6-8 g.","8-10 g.","10-12 g.","S","M","L","XL"]},{name:"Boja",slug:"pa_color",type:"select",order_by:"name",has_archives:!1,terms:["Crna","Siva","Tirkizna","Cijan","Plava","Ljubičasta","Bijela","Roza","Mint"]},{name:"Dizajn",slug:"pa_design",type:"select",order_by:"name",has_archives:!1,terms:["Street 1","Street 2","Street 3","Street 4","Street 5","Street 6","Street 7","Street 8","Street 9","Street 10","Vintage 1","Vintage 2","Vintage 3","Vintage 4","Vintage 5","Logo 1","Logo 2","Logo 3","Logo 4","Logo 5","Logo 6","Logo 7","Logo 8","Logo 9","Logo 10","Logo 11","Logo 12","Kids Badge","Street Badge","Vintage Badge"]}],ce=()=>{const[t,u]=c.useState(!1),[b,j]=c.useState([]),{toast:m}=L(),i=s=>j(d=>[...d,`${new Date().toLocaleTimeString()} - ${s}`]),p=async()=>{u(!0),j([]),i("Starting attribute synchronization...");try{const s=V();i("Fetching existing attributes...");const d=await w("/wc/v3/products/attributes",{headers:s});for(const o of ne){let l;const a=d.find(n=>n.slug===o.slug);if(a?(l=a.id,i(`Attribute '${o.name}' already exists (ID: ${l}).`)):(i(`Creating attribute '${o.name}'...`),l=(await w("/wc/v3/products/attributes",{method:"POST",headers:s,body:JSON.stringify({name:o.name,slug:o.slug,type:o.type,order_by:o.order_by,has_archives:o.has_archives})})).id,i(`Created attribute '${o.name}' (ID: ${l}).`)),l){i(`Syncing terms for '${o.name}'...`);const y=(await w(`/wc/v3/products/attributes/${l}/terms?per_page=100`,{headers:s})).map(h=>h.name);for(const h of o.terms)if(!y.includes(h))try{await w(`/wc/v3/products/attributes/${l}/terms`,{method:"POST",headers:s,body:JSON.stringify({name:h})}),i(`  + Added term: ${h}`)}catch(N){i(`  ! Failed to add term ${h}: ${N.message}`)}}}i("Synchronization complete!"),m({title:"Success",description:"Attributes synced successfully."})}catch(s){console.error("Sync failed:",s),i(`Error: ${s.message}`),m({title:"Error",description:"Sync failed. Check console.",variant:"destructive"})}finally{u(!1)}};return e.jsxs(D,{children:[e.jsxs(B,{children:[e.jsx(O,{className:"text-lg",children:"WooCommerce Attributes Sync"}),e.jsx(R,{children:"Automatically create Attributes (Size, Color, Design) and their Terms in WooCommerce to match your site options."})]}),e.jsxs(q,{children:[e.jsxs(f,{onClick:p,disabled:t,className:"w-full sm:w-auto",children:[t?e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(se,{className:"w-4 h-4 mr-2"}),t?"Syncing...":"Sync Attributes Now"]}),b.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-md border text-xs font-mono max-h-60 overflow-y-auto space-y-1",children:b.map((s,d)=>e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:s.includes("Error")||s.includes("Failed")?"text-red-500":"text-gray-600",children:s})},d))})]})]})},A={Crna:"#231f20",Siva:"#d1d5db",Tirkizna:"#00ab98",Cijan:"#00aeef",Plava:"#387bbf",Ljubičasta:"#8358a4",Bijela:"#ffffff",Roza:"#e78fab",Mint:"#a1d7c0"},de=({product:t,onDelete:u,onUpdate:b})=>{var P;const j=$(),{toast:m}=L(),[i,p]=c.useState(!1),[s,d]=c.useState([]),[o,l]=c.useState(!1),[a,n]=c.useState(!1),[y,h]=c.useState(t.stock_quantity||0),[N,_]=c.useState({}),v=t.type==="variable",z=async()=>{if(!i&&v&&s.length===0){l(!0);try{const r=await H(t.id);d(r);const x={};r.forEach(g=>{x[g.id]=g.stock_quantity||0}),_(x)}catch(r){console.error("Failed to fetch variations",r),m({title:"Error",description:"Failed to fetch variations",variant:"destructive"})}finally{l(!1)}}p(!i)},E=async()=>{n(!0);try{v||await K(t.id,{manage_stock:!0,stock_quantity:y}),v&&s.length>0&&await Promise.all(s.map(r=>W(t.id,r.id,{manage_stock:!0,stock_quantity:N[r.id]}))),m({title:"Success",description:"Stock updated successfully"}),b()}catch(r){console.error(r),m({title:"Error",description:"Failed to update stock",variant:"destructive"})}finally{n(!1)}};return e.jsxs(D,{className:"mb-6 overflow-hidden border-none shadow-xl shadow-slate-200/50 bg-white rounded-[2rem] transition-all hover:shadow-2xl hover:shadow-primary/5 group",children:[e.jsxs("div",{className:"p-6 flex flex-col lg:flex-row items-start lg:items-center gap-6",children:[e.jsx("div",{className:"h-24 w-24 rounded-3xl bg-slate-50 flex-shrink-0 overflow-hidden border border-slate-100 shadow-inner group-hover:scale-105 transition-transform duration-500",children:(P=t.images)!=null&&P[0]?e.jsx("img",{src:t.images[0].src,alt:t.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(C,{className:"w-10 h-10 opacity-50"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(X,{variant:t.stock_status==="instock"?"default":"destructive",className:"text-[10px] uppercase tracking-tighter font-black px-2.5 py-1 rounded-full",children:t.stock_status==="instock"?"Dostupno":"Rasprodano"}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:["ID: ",t.id]})]}),e.jsx("h3",{className:"text-xl font-black text-slate-900 truncate leading-tight mb-1",children:t.name}),e.jsxs("p",{className:"text-lg font-bold text-primary italic",children:["€",t.price]})]}),!v&&e.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[120px]",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"Zaliha"}),e.jsx("div",{className:"relative",children:e.jsx(k,{type:"number",className:"w-full h-12 rounded-xl bg-slate-50 border-slate-100 focus:bg-white transition-colors font-bold pl-4",value:y,onChange:r=>h(parseInt(r.target.value)||0)})})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto mt-4 lg:mt-0 pt-4 lg:pt-0 border-t lg:border-t-0 border-slate-50",children:[v&&e.jsxs(f,{variant:"secondary",size:"lg",onClick:z,className:"flex-1 lg:flex-none gap-2 rounded-xl font-bold text-xs uppercase tracking-wider bg-slate-100 hover:bg-slate-200 text-slate-900 border-none transition-all shadow-sm",children:[i?e.jsx(G,{className:"w-4 h-4"}):e.jsx(Y,{className:"w-4 h-4"}),"Varijacije"]}),e.jsxs("div",{className:"flex gap-2 ml-auto lg:ml-0",children:[e.jsx(f,{variant:"outline",size:"icon",className:"h-12 w-12 rounded-xl border-slate-100 hover:border-blue-100 hover:bg-blue-50 text-blue-600 transition-all shadow-sm",onClick:()=>j(`/admin/products/edit/${t.id}`),children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx(f,{variant:"outline",size:"icon",className:"h-12 w-12 rounded-xl border-slate-100 hover:border-red-100 hover:bg-red-50 text-red-600 transition-all shadow-sm",onClick:()=>u(t.id),children:e.jsx(ie,{className:"w-4 h-4"})}),e.jsxs(f,{onClick:E,disabled:a,size:"lg",className:J("h-12 px-6 rounded-xl font-bold text-xs uppercase tracking-wider shadow-lg transition-all",a?"opacity-70":"hover:shadow-primary/30"),children:[a?e.jsx(S,{className:"w-4 h-4 animate-spin"}):e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Spremi"]})]})]})]}),e.jsx(ee,{open:i,className:"bg-slate-50/50 border-t border-slate-100",children:e.jsx(te,{children:e.jsx("div",{className:"p-8 space-y-4",children:o?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(S,{className:"w-8 h-8 animate-spin text-primary"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest animate-pulse",children:"Učitavanje varijacija..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-8 px-4 text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4",children:[e.jsx("div",{className:"col-span-8",children:"Varijacija"}),e.jsx("div",{className:"col-span-4 pl-4 text-center",children:"Zaliha"})]}),e.jsx("div",{className:"space-y-3",children:s.map(r=>e.jsxs("div",{className:"grid grid-cols-12 gap-8 items-center bg-white p-5 rounded-2xl border border-slate-100 shadow-sm hover:border-primary/20 transition-all group/var",children:[e.jsxs("div",{className:"col-span-8 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(()=>{var T;const x=(T=r.attributes)==null?void 0:T.find(F=>A[F.option]),g=x?A[x.option]:null;return g?e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-200 shadow-inner shrink-0 scale-110",style:{backgroundColor:g}}):e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-200 bg-slate-100 shrink-0"})})(),e.jsx("span",{className:"font-bold text-slate-900 text-sm",children:r.attributes.map(x=>`${x.option}`).join(" / ")})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5 ml-7 text-[10px] font-bold text-slate-400",children:[e.jsxs("span",{className:"uppercase tracking-widest",children:["ID: ",r.id]}),e.jsxs("span",{className:"text-primary italic",children:["€",r.price]})]})]}),e.jsx("div",{className:"col-span-4",children:e.jsx(k,{type:"number",className:"h-10 rounded-xl bg-slate-50 text-center border-none font-bold focus:bg-white transition-all",value:N[r.id]||0,onChange:x=>_(g=>({...g,[r.id]:parseInt(x.target.value)||0}))})})]},r.id))})]})})})})]})},ve=()=>{const[t,u]=c.useState([]),[b,j]=c.useState(!0),[m,i]=c.useState(""),{toast:p}=L(),s=$(),d=async()=>{try{const a=await Q(1,100);u(a)}catch(a){console.error("Failed to fetch products:",a),p({title:"Error",description:"Failed to load products.",variant:"destructive"})}finally{j(!1)}};c.useEffect(()=>{d()},[]);const o=async a=>{if(confirm("Are you sure you want to delete this product?"))try{await w(`/wc/v3/products/${a}?force=true`,{method:"DELETE",headers:V()}),u(t.filter(n=>n.id!==a)),p({title:"Success",description:"Product deleted successfully"})}catch{p({title:"Error",description:"Failed to delete product",variant:"destructive"})}},l=(t||[]).filter(a=>{var n;return(n=a.name)==null?void 0:n.toLowerCase().includes(m.toLowerCase())});return e.jsxs("div",{className:"space-y-10 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-slate-200/60 pb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black font-heading text-slate-900 tracking-tight uppercase",children:"PROIZVODI"}),e.jsx("p",{className:"text-slate-500 text-lg font-medium mt-1",children:"Upravljajte svojim proizvodima i zalihama."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(M,{children:[e.jsx(U,{asChild:!0,children:e.jsx(f,{variant:"outline",className:"h-12 px-6 rounded-xl font-bold text-xs uppercase tracking-wider border-slate-200 hover:bg-slate-50 transition-all",children:"Atributi"})}),e.jsx(Z,{className:"sm:max-w-md rounded-[2.5rem] p-0 overflow-hidden border-none shadow-2xl",children:e.jsx(ce,{})})]}),e.jsxs(f,{onClick:()=>s("/admin/products/new"),className:"h-12 px-6 rounded-xl font-black text-xs uppercase tracking-widest shadow-xl shadow-primary/20 hover:shadow-primary/30 transition-all",children:[e.jsx(ae,{className:"w-4 h-4 mr-2 stroke-[3]"})," Novi Proizvod"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 bg-white p-3 rounded-2xl border border-slate-100 shadow-xl shadow-slate-200/40 max-w-xl group focus-within:border-primary/30 transition-all",children:[e.jsx(le,{className:"w-5 h-5 text-slate-400 ml-2 group-focus-within:text-primary transition-colors"}),e.jsx(k,{placeholder:"Pretraži proizvode...",value:m,onChange:a=>i(a.target.value),className:"border-none shadow-none focus-visible:ring-0 text-slate-900 font-bold placeholder:text-slate-300 text-base"})]}),e.jsx("div",{className:"space-y-4",children:b?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-pulse",children:[e.jsx(C,{className:"w-12 h-12 text-gray-200 mb-4"}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Loading inventory..."})]}):e.jsxs(e.Fragment,{children:[l.map(a=>e.jsx(de,{product:a,onDelete:o,onUpdate:d},a.id)),l.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border border-dashed",children:[e.jsx(C,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"No products found matching your search."})]})]})})]})};export{ve as default};
