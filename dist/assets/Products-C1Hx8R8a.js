import{l as R,r as c,b as L,j as e,a as V,F as q,J as M,Q as Z,K as U,B as b,L as S,T,V as y,u as $,n as D,I as k,s as J,W as Q,Y as W,Z as H}from"./index-W2Y9FM_P.js";import{B as K}from"./badge-szy-dN0r.js";import{C as E,a as I}from"./collapsible-CSEw5cIZ.js";import{R as X}from"./refresh-cw-Cq9AoVxd.js";import{P as Y}from"./plus-DdoNv4k-.js";import{P as C}from"./package-DELsTF_f.js";import{C as G,a as ee}from"./chevron-up-DKln7c6E.js";import{S as te}from"./square-pen-CldVce2j.js";import{T as se}from"./trash-2-BNDFjM6G.js";import{S as ae}from"./save-ojyIshI4.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=R("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ie=[{name:"Veličina",slug:"pa_size",type:"select",order_by:"menu_order",has_archives:!1,terms:["6-8 g.","8-10 g.","10-12 g.","S","M","L","XL"]},{name:"Boja",slug:"pa_color",type:"select",order_by:"name",has_archives:!1,terms:["Crna","Siva","Tirkizna","Cijan","Plava","Ljubičasta","Bijela","Roza","Mint"]},{name:"Dizajn",slug:"pa_design",type:"select",order_by:"name",has_archives:!1,terms:["Street 1","Street 2","Street 3","Street 4","Street 5","Street 6","Street 7","Street 8","Street 9","Street 10","Vintage 1","Vintage 2","Vintage 3","Vintage 4","Vintage 5","Logo 1","Logo 2","Logo 3","Logo 4","Logo 5","Logo 6","Logo 7","Logo 8","Logo 9","Logo 10","Logo 11","Logo 12","Kids Badge","Street Badge","Vintage Badge"]}],le=()=>{const[t,g]=c.useState(!1),[j,v]=c.useState([]),{toast:m}=L(),i=s=>v(d=>[...d,`${new Date().toLocaleTimeString()} - ${s}`]),u=async()=>{g(!0),v([]),i("Starting attribute synchronization...");try{const s=T();i("Fetching existing attributes...");const d=await y("/wc/v3/products/attributes",{headers:s});for(const l of ie){let o;const p=d.find(h=>h.slug===l.slug);if(p?(o=p.id,i(`Attribute '${l.name}' already exists (ID: ${o}).`)):(i(`Creating attribute '${l.name}'...`),o=(await y("/wc/v3/products/attributes",{method:"POST",headers:s,body:JSON.stringify({name:l.name,slug:l.slug,type:l.type,order_by:l.order_by,has_archives:l.has_archives})})).id,i(`Created attribute '${l.name}' (ID: ${o}).`)),o){i(`Syncing terms for '${l.name}'...`);const r=(await y(`/wc/v3/products/attributes/${o}/terms?per_page=100`,{headers:s})).map(n=>n.name);for(const n of l.terms)if(!r.includes(n))try{await y(`/wc/v3/products/attributes/${o}/terms`,{method:"POST",headers:s,body:JSON.stringify({name:n})}),i(`  + Added term: ${n}`)}catch(N){i(`  ! Failed to add term ${n}: ${N.message}`)}}}i("Synchronization complete!"),m({title:"Success",description:"Attributes synced successfully."})}catch(s){console.error("Sync failed:",s),i(`Error: ${s.message}`),m({title:"Error",description:"Sync failed. Check console.",variant:"destructive"})}finally{g(!1)}};return e.jsxs(V,{children:[e.jsxs(q,{children:[e.jsx(M,{className:"text-lg",children:"WooCommerce Attributes Sync"}),e.jsx(Z,{children:"Automatically create Attributes (Size, Color, Design) and their Terms in WooCommerce to match your site options."})]}),e.jsxs(U,{children:[e.jsxs(b,{onClick:u,disabled:t,className:"w-full sm:w-auto",children:[t?e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(X,{className:"w-4 h-4 mr-2"}),t?"Syncing...":"Sync Attributes Now"]}),j.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-md border text-xs font-mono max-h-60 overflow-y-auto space-y-1",children:j.map((s,d)=>e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:s.includes("Error")||s.includes("Failed")?"text-red-500":"text-gray-600",children:s})},d))})]})]})},z={Crna:"#231f20",Siva:"#d1d5db",Tirkizna:"#00ab98",Cijan:"#00aeef",Plava:"#387bbf",Ljubičasta:"#8358a4",Bijela:"#ffffff",Roza:"#e78fab",Mint:"#a1d7c0"},ne=({product:t,onDelete:g,onUpdate:j})=>{var _;const v=$(),{toast:m}=L(),[i,u]=c.useState(!1),[s,d]=c.useState([]),[l,o]=c.useState(!1),[p,h]=c.useState(!1),[r,n]=c.useState(t.stock_quantity||0),[N,P]=c.useState({}),w=t.type==="variable",F=async()=>{if(!i&&w&&s.length===0){o(!0);try{const a=await Q(t.id);d(a);const x={};a.forEach(f=>{x[f.id]=f.stock_quantity||0}),P(x)}catch(a){console.error("Failed to fetch variations",a),m({title:"Error",description:"Failed to fetch variations",variant:"destructive"})}finally{o(!1)}}u(!i)},O=async()=>{h(!0);try{w||await W(t.id,{manage_stock:!0,stock_quantity:r}),w&&s.length>0&&await Promise.all(s.map(a=>H(t.id,a.id,{manage_stock:!0,stock_quantity:N[a.id]}))),m({title:"Success",description:"Stock updated successfully"}),j()}catch(a){console.error(a),m({title:"Error",description:"Failed to update stock",variant:"destructive"})}finally{h(!1)}};return e.jsxs(V,{className:"mb-6 overflow-hidden border-none shadow-lg shadow-slate-200/30 bg-white rounded-[2rem] transition-all hover:shadow-xl hover:shadow-primary/5 group",children:[e.jsxs("div",{className:"p-4 md:p-6 flex flex-col lg:flex-row items-start lg:items-center gap-4 md:gap-6",children:[e.jsx("div",{className:"h-20 w-20 md:h-24 md:w-24 rounded-2xl md:rounded-3xl bg-slate-50 flex-shrink-0 overflow-hidden border border-slate-100 shadow-inner group-hover:scale-105 transition-transform duration-500",children:(_=t.images)!=null&&_[0]?e.jsx("img",{src:t.images[0].src,alt:t.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-slate-300",children:e.jsx(C,{className:"w-8 h-8 md:w-10 md:h-10 opacity-50"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(K,{variant:t.stock_status==="instock"?"default":"destructive",className:"text-[10px] uppercase tracking-tighter font-black px-2.5 py-1 rounded-full",children:t.stock_status==="instock"?"Dostupno":"Rasprodano"}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:["ID: ",t.id]})]}),e.jsx("h3",{className:"text-lg md:text-xl font-black text-slate-900 truncate leading-tight mb-1",children:t.name}),e.jsxs("p",{className:"text-base md:text-lg font-bold text-primary italic",children:["€",t.price]})]}),!w&&e.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[120px]",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1.5 ml-1",children:"Zaliha"}),e.jsx("div",{className:"relative",children:e.jsx(k,{type:"number",className:"w-full h-12 rounded-full bg-slate-50 border-slate-100 focus:bg-white transition-colors font-bold pl-6",value:r,onChange:a=>n(parseInt(a.target.value)||0)})})]}),e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3 w-full lg:w-auto mt-2 lg:mt-0 pt-3 lg:pt-0 border-t lg:border-t-0 border-slate-50",children:[w&&e.jsxs(b,{variant:"secondary",size:"lg",onClick:F,className:"flex-1 lg:flex-none h-11 lg:h-12 gap-2 rounded-full font-bold text-[10px] lg:text-xs uppercase tracking-wider bg-slate-100 hover:bg-slate-200 text-slate-900 border-none transition-all shadow-sm",children:[i?e.jsx(G,{className:"w-4 h-4"}):e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Varijacije"}),e.jsx("span",{className:"sm:hidden",children:"Opcije"})]}),e.jsxs("div",{className:"flex gap-2 ml-auto lg:ml-0",children:[e.jsx(b,{variant:"outline",size:"icon",className:"h-11 w-11 lg:h-12 lg:w-12 rounded-full border-slate-100 hover:border-blue-100 hover:bg-blue-50 text-blue-600 transition-all shadow-sm",onClick:()=>v(`/admin/products/edit/${t.id}`),children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx(b,{variant:"outline",size:"icon",className:"h-11 w-11 lg:h-12 lg:w-12 rounded-full border-slate-100 hover:border-red-100 hover:bg-red-50 text-red-600 transition-all shadow-sm",onClick:()=>g(t.id),children:e.jsx(se,{className:"w-4 h-4"})}),e.jsxs(b,{onClick:O,disabled:p,size:"lg",className:D("h-11 lg:h-12 px-4 lg:px-6 rounded-full font-bold text-[10px] lg:text-xs uppercase tracking-wider shadow-md transition-all",p?"opacity-70":"hover:shadow-primary/20"),children:[p?e.jsx(S,{className:"w-4 h-4 animate-spin"}):e.jsx(ae,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Spremi"})]})]})]})]}),e.jsx(E,{open:i,className:"bg-slate-50/50 border-t border-slate-100",children:e.jsx(I,{children:e.jsx("div",{className:"p-8 space-y-4",children:l?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(S,{className:"w-8 h-8 animate-spin text-primary"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest animate-pulse",children:"Učitavanje varijacija..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-8 px-4 text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4",children:[e.jsx("div",{className:"col-span-8",children:"Varijacija"}),e.jsx("div",{className:"col-span-4 pl-4 text-center",children:"Zaliha"})]}),e.jsx("div",{className:"space-y-3",children:s.map(a=>e.jsxs("div",{className:"grid grid-cols-12 gap-8 items-center bg-white p-5 rounded-2xl border border-slate-100 shadow-sm hover:border-primary/20 transition-all group/var",children:[e.jsxs("div",{className:"col-span-8 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(()=>{var A;const x=(A=a.attributes)==null?void 0:A.find(B=>z[B.option]),f=x?z[x.option]:null;return f?e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-200 shadow-inner shrink-0 scale-110",style:{backgroundColor:f}}):e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-200 bg-slate-100 shrink-0"})})(),e.jsx("span",{className:"font-bold text-slate-900 text-sm",children:a.attributes.map(x=>`${x.option}`).join(" / ")})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5 ml-7 text-[10px] font-bold text-slate-400",children:[e.jsxs("span",{className:"uppercase tracking-widest",children:["ID: ",a.id]}),e.jsxs("span",{className:"text-primary italic",children:["€",a.price]})]})]}),e.jsx("div",{className:"col-span-4",children:e.jsx(k,{type:"number",className:"h-10 rounded-full bg-slate-50 text-center border-none font-bold focus:bg-white transition-all px-4",value:N[a.id]||0,onChange:x=>P(f=>({...f,[a.id]:parseInt(x.target.value)||0}))})})]},a.id))})]})})})})]})},be=()=>{const[t,g]=c.useState([]),[j,v]=c.useState(!0),[m,i]=c.useState(""),[u,s]=c.useState(!1),{toast:d}=L(),l=$(),o=async()=>{try{const r=await J(1,100);g(r)}catch(r){console.error("Failed to fetch products:",r),d({title:"Error",description:"Failed to load products.",variant:"destructive"})}finally{v(!1)}};c.useEffect(()=>{o()},[]);const p=async r=>{if(confirm("Are you sure you want to delete this product?"))try{await y(`/wc/v3/products/${r}?force=true`,{method:"DELETE",headers:T()}),g(t.filter(n=>n.id!==r)),d({title:"Success",description:"Product deleted successfully"})}catch{d({title:"Error",description:"Failed to delete product",variant:"destructive"})}},h=(t||[]).filter(r=>{var n;return(n=r.name)==null?void 0:n.toLowerCase().includes(m.toLowerCase())});return e.jsxs("div",{className:"space-y-10 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-slate-200/60 pb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black font-heading text-slate-900 tracking-tight uppercase",children:"PROIZVODI"}),e.jsx("p",{className:"text-slate-500 text-lg font-medium mt-1",children:"Upravljajte svojim proizvodima i zalihama."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"outline",onClick:()=>s(!u),className:D("h-12 px-6 rounded-full font-bold text-xs uppercase tracking-wider border-slate-200 transition-all",u?"bg-slate-100 border-primary/20":"hover:bg-slate-50"),children:u?"Zatvori Atribute":"Sinkroniziraj Atribute"}),e.jsxs(b,{onClick:()=>l("/admin/products/new"),className:"h-12 px-6 rounded-full font-black text-xs uppercase tracking-widest shadow-lg shadow-primary/10 hover:shadow-primary/20 transition-all",children:[e.jsx(Y,{className:"w-4 h-4 mr-2 stroke-[3]"})," Novi Proizvod"]})]})]}),e.jsx(E,{open:u,children:e.jsx(I,{children:e.jsx("div",{className:"bg-white p-2 rounded-[2.5rem] border border-slate-100 shadow-xl shadow-slate-200/40 mb-10 overflow-hidden",children:e.jsx(le,{})})})}),e.jsxs("div",{className:"flex items-center gap-4 bg-white p-3 rounded-2xl border border-slate-100 shadow-lg shadow-slate-200/30 max-w-xl group focus-within:border-primary/30 transition-all",children:[e.jsx(re,{className:"w-5 h-5 text-slate-400 ml-2 group-focus-within:text-primary transition-colors"}),e.jsx(k,{placeholder:"Pretraži proizvode...",value:m,onChange:r=>i(r.target.value),className:"border-none shadow-none focus-visible:ring-0 text-slate-900 font-bold placeholder:text-slate-300 text-base"})]}),e.jsx("div",{className:"space-y-4",children:j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 animate-pulse",children:[e.jsx(C,{className:"w-12 h-12 text-gray-200 mb-4"}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Loading inventory..."})]}):e.jsxs(e.Fragment,{children:[h.map(r=>e.jsx(ne,{product:r,onDelete:p,onUpdate:o},r.id)),h.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 text-center bg-white rounded-[3rem] border border-dashed border-slate-200 shadow-sm animate-in fade-in duration-700",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-slate-50 flex items-center justify-center mb-8 shadow-inner",children:e.jsx(C,{className:"h-10 w-10 text-slate-300"})}),e.jsx("h3",{className:"text-2xl font-black text-slate-900 tracking-tight uppercase",children:"NEMA PROIZVODA"}),e.jsx("p",{className:"text-slate-500 max-w-xs mt-3 font-medium leading-relaxed",children:"Nismo pronašli nijedan proizvod koji odgovara vašoj pretrazi."})]})]})})]})};export{be as default};
