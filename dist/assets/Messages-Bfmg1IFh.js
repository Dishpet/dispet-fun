import{l as C,r as a,j as e,a9 as se,n as ae,aE as re,B as i,a as z,x as te,aF as w,aG as b,aH as k,Q as D,V as I,W as M,Y as U,aI as B,g as h,I as S,aJ as A,a4 as m}from"./index-Cai6JexK.js";import{T as H}from"./textarea-ELVwYViW.js";import{B as oe}from"./badge-DFTisaxB.js";import{R as ie}from"./refresh-cw-BsxbEwQr.js";import{M as ne}from"./mail-CUh_Ia1U.js";import{C as le}from"./clock-BiRxc9Qf.js";import{T as de}from"./trash-2-Yl06RyXF.js";import{S as ce}from"./send-CSo6Pakl.js";import{f as me,h as pe}from"./hr-DgTxfRwo.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=C("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=C("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=C("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);var xe="Separator",$="horizontal",he=["horizontal","vertical"],J=a.forwardRef((t,o)=>{const{decorative:p,orientation:l=$,...x}=t,d=ue(l)?l:$,u=p?{role:"none"}:{"aria-orientation":d==="vertical"?d:void 0,role:"separator"};return e.jsx(se.div,{"data-orientation":d,...u,...x,ref:o})});J.displayName=xe;function ue(t){return he.includes(t)}var G=J;const Q=a.forwardRef(({className:t,orientation:o="horizontal",decorative:p=!0,...l},x)=>e.jsx(G,{ref:x,decorative:p,orientation:o,className:ae("shrink-0 bg-border",o==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...l}));Q.displayName=G.displayName;const Se=()=>{const[t,o]=a.useState([]),[p,l]=a.useState(!0),[x,d]=a.useState(!1),[r,u]=a.useState(null),[W,j]=a.useState(!1),[Y,g]=a.useState(!1),[T,P]=a.useState(""),[F,_]=a.useState(""),[R,E]=a.useState(""),[f,v]=a.useState(!1),y=async(s=!1)=>{s&&d(!0);try{const c=await fetch("/api/messages");if(c.ok){const N=await c.json();o(N)}}catch(n){console.error("Failed to fetch messages",n),m.error("Greška pri osvježavanju poruka")}finally{l(!1),s&&d(!1)}};a.useEffect(()=>{y();const s=setInterval(()=>y(!1),3e4);return()=>clearInterval(s)},[]);const q=async s=>{const n=[...t];o(c=>c.filter(N=>N.id!==s)),m.promise(async()=>{const c=`/api/messages/${s}`;if(!(await fetch(c,{method:"DELETE"})).ok)throw new Error("Failed")},{loading:"Brisanje...",success:"Poruka obrisana",error:()=>(o(n),"Neuspješno brisanje")})},K=s=>{u(s),P(`

Poštovani/a ${s.name},

Hvala na vašem upitu.

Srdačan pozdrav,
Dišpet Tim`),j(!0)},X=s=>{u(s),E("Ovdje prosljeđujem ovaj upit..."),g(!0)},Z=async()=>{if(r){v(!0);try{if((await fetch("/api/messages/reply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:r.email,subject:"Re: Vaša poruka za Dišpet",body:T})})).ok)m.success("Odgovor uspješno poslan!"),j(!1);else throw new Error("Send failed")}catch(s){console.error(s),m.error("Slanje nije uspjelo")}finally{v(!1)}}},ee=async()=>{if(r){v(!0);try{if((await fetch("/api/messages/forward",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:F,subject:`Fwd: Poruka od ${r.name}`,body:R,originalMessage:r})})).ok)m.success("Poruka uspješno proslijeđena!"),g(!1);else throw new Error("Send failed")}catch(s){console.error(s),m.error("Slanje nije uspjelo")}finally{v(!1)}}};return p?e.jsx("div",{className:"flex h-[50vh] w-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 animate-pulse",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(L,{className:"h-6 w-6 text-primary"})}),e.jsx("p",{className:"text-muted-foreground font-medium",children:"Učitavanje inboxa..."})]})}):e.jsx(re,{children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold font-heading bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Inbox"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-lg",children:"Upravljajte porukama posjetitelja i kupaca."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(oe,{variant:"secondary",className:"px-3 py-1 text-sm h-9",children:["Ukupno: ",t.length]}),e.jsx(i,{variant:"outline",size:"icon",onClick:()=>y(!0),className:x?"animate-spin":"",children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsxs(z,{className:"flex flex-col items-center justify-center py-24 text-center border-dashed border-2",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-gray-50 flex items-center justify-center mb-6",children:e.jsx(L,{className:"h-10 w-10 text-gray-300"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Nema novih poruka"}),e.jsx("p",{className:"text-muted-foreground max-w-sm mt-2",children:"Trenutno je vaš inbox prazan. Nove poruke s kontakt forme pojavit će se ovdje."})]}):e.jsx("div",{className:"grid gap-4",children:t.map((s,n)=>e.jsxs(z,{className:"group relative overflow-hidden transition-all duration-300 hover:shadow-lg border-border/60",children:[e.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-gradient-to-b from-primary to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4 min-w-[200px]",children:[e.jsx("div",{className:"h-12 w-12 shrink-0 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-md ring-2 ring-white",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 leading-none pb-1",children:s.name}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5 hover:text-primary transition-colors cursor-pointer",children:[e.jsx(ne,{className:"w-3.5 h-3.5"})," ",s.email]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(te,{className:"w-3.5 h-3.5"})," ",s.phone]})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0 py-1 md:px-4 md:border-l md:border-gray-100",children:e.jsx("div",{className:"prose prose-sm max-w-none text-gray-600 leading-relaxed whitespace-pre-wrap",children:s.message})}),e.jsxs("div",{className:"flex md:flex-col items-center md:items-end justify-between md:justify-start gap-4 min-w-[140px] pl-4 md:border-l md:border-gray-100 md:bg-gray-50/50 md:-my-6 md:-mr-6 md:p-6",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-muted-foreground bg-white px-2.5 py-1 rounded-full border shadow-sm",children:[e.jsx(le,{className:"w-3.5 h-3.5"}),me(new Date(s.date),"dd. MMM, HH:mm",{locale:pe})]}),e.jsxs("div",{className:"flex items-center gap-1 pt-2",children:[e.jsxs(w,{children:[e.jsx(b,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"h-9 w-9 text-blue-600 hover:text-blue-700 hover:bg-blue-50 transition-colors",onClick:()=>K(s),children:e.jsx(V,{className:"w-4 h-4"})})}),e.jsx(k,{children:"Odgovori"})]}),e.jsxs(w,{children:[e.jsx(b,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"h-9 w-9 text-green-600 hover:text-green-700 hover:bg-green-50 transition-colors",onClick:()=>X(s),children:e.jsx(O,{className:"w-4 h-4"})})}),e.jsx(k,{children:"Proslijedi"})]}),e.jsx(Q,{orientation:"vertical",className:"h-6 mx-1"}),e.jsxs(w,{children:[e.jsx(b,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"h-9 w-9 text-red-500 hover:text-red-600 hover:bg-red-50 transition-colors",onClick:()=>q(s.id),children:e.jsx(de,{className:"w-4 h-4"})})}),e.jsx(k,{children:"Obriši poruku"})]})]})]})]})})]},s.id))})}),e.jsx(D,{open:W,onOpenChange:j,children:e.jsxs(I,{className:"sm:max-w-2xl",children:[e.jsxs(M,{children:[e.jsxs(U,{className:"flex items-center gap-2 text-xl",children:[e.jsx(V,{className:"w-5 h-5 text-primary"}),"Odgovori korisniku"]}),e.jsx(B,{children:"Vaš odgovor bit će poslan direktno na email korisnika."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(h,{htmlFor:"to",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Primatelj"}),e.jsx(S,{id:"to",value:(r==null?void 0:r.email)||"",disabled:!0,className:"bg-gray-50 border-gray-200"})]}),e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(h,{htmlFor:"subject",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Predmet"}),e.jsx(S,{id:"subject",value:"Re: Vaša poruka za Dišpet",disabled:!0,className:"bg-gray-50 border-gray-200"})]}),e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(h,{htmlFor:"message",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Vaš Odgovor"}),e.jsx(H,{id:"message",value:T,onChange:s=>P(s.target.value),className:"min-h-[250px] font-normal leading-relaxed resize-none p-4",placeholder:"Napišite svoj odgovor ovdje..."})]})]}),e.jsxs(A,{className:"gap-2 sm:gap-0",children:[e.jsx(i,{variant:"outline",onClick:()=>j(!1),children:"Odustani"}),e.jsxs(i,{onClick:Z,disabled:f,className:"pl-4 pr-6",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),f?"Slanje...":"Pošalji Odgovor"]})]})]})}),e.jsx(D,{open:Y,onOpenChange:g,children:e.jsxs(I,{className:"sm:max-w-xl",children:[e.jsxs(M,{children:[e.jsxs(U,{className:"flex items-center gap-2 text-xl",children:[e.jsx(O,{className:"w-5 h-5 text-green-600"}),"Proslijedi poruku"]}),e.jsx(B,{children:"Proslijedite originalnu poruku trećoj strani."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(h,{htmlFor:"fwd-to",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Proslijedi na Email"}),e.jsx(S,{id:"fwd-to",placeholder:"ime@primjer.com",value:F,onChange:s=>_(s.target.value),className:"bg-white"})]}),e.jsxs("div",{className:"grid gap-1.5",children:[e.jsx(h,{htmlFor:"fwd-message",className:"text-xs uppercase text-muted-foreground font-bold tracking-wider",children:"Napomena (Opcionalno)"}),e.jsx(H,{id:"fwd-message",value:R,onChange:s=>E(s.target.value),className:"min-h-[120px] resize-none",placeholder:"Dodajte napomenu uz prosljeđenu poruku..."})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md border text-sm text-gray-500",children:[e.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:"Originalna poruka:"}),e.jsxs("p",{className:"line-clamp-3 italic",children:['"',r==null?void 0:r.message,'"']})]})]}),e.jsxs(A,{className:"gap-2 sm:gap-0",children:[e.jsx(i,{variant:"outline",onClick:()=>g(!1),children:"Odustani"}),e.jsxs(i,{onClick:ee,disabled:f,className:"bg-green-600 hover:bg-green-700 text-white pl-4 pr-6",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),f?"Slanje...":"Proslijedi"]})]})]})})]})})};export{Se as default};
