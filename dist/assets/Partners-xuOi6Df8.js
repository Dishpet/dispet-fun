import{k as B,r as n,a as H,j as e,B as d,L as U,F as J,K as _,N as G,O as K,Q,f as v,I as A}from"./index-BRjihD9z.js";import{T as W,a as q,b as m,c as g,d as V,e as i}from"./table-C-l6MuV4.js";import{g as X,u as Y,c as Z}from"./posts-B8QnHS4d.js";import{M as $}from"./MediaPicker-3bXCPqmt.js";import{c as ee,d as se,n as ae,s as te}from"./sun-city-sport-CUCMvFAA.js";import{P as ne}from"./plus-DENmbbAT.js";import{T as ie}from"./trash-2-BKVhw_Kt.js";import"./check-DpwtoIry.js";import"./chevron-right-dV3snEP-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=B("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),D=[{id:"def-1",name:"Caelor",link:"",logoUrl:ee},{id:"def-2",name:"Digital Produkt",link:"",logoUrl:se},{id:"def-3",name:"NK Spalato",link:"",logoUrl:ae},{id:"def-4",name:"Sun City Sport",link:"",logoUrl:te}],E="config-partners";function ue(){const[y,k]=n.useState(null),[r,h]=n.useState([]),[S,x]=n.useState(!0),[C,P]=n.useState(!1),[I,l]=n.useState(!1),[o,b]=n.useState(null),[L,p]=n.useState(""),[w,u]=n.useState(""),[f,j]=n.useState(""),{toast:c}=H();n.useEffect(()=>{O()},[]);const O=async()=>{x(!0);try{const t=(await X()).find(a=>a.slug===E);if(t){k(t);try{const a=t.content.rendered.replace(/<[^>]*>?/gm,""),N=JSON.parse(a);if(Array.isArray(N)&&N.length>0){h(N),x(!1);return}}catch(a){console.error("Failed to parse partners config",a)}}h(D)}catch(s){console.error(s),h(D),c({title:"Error",description:"Failed to load configuration. Showing defaults.",variant:"destructive"})}finally{x(!1)}},T=async s=>{P(!0);const t=JSON.stringify(s);try{if(y)await Y(y.id,{content:t}),c({title:"Saved",description:"Partners list updated."});else{const a=await Z({title:"System Config: Partners",content:t,slug:E,status:"private"});k(a),c({title:"Created",description:"Configuration initialized."})}h(s)}catch(a){console.error(a),c({title:"Error",description:"Failed to save configuration",variant:"destructive"})}finally{P(!1),l(!1)}},F=s=>{b(s.id),p(s.name),u(s.link),j(s.logoUrl),l(!0)},M=()=>{b(null),p(""),u(""),j(""),l(!0)},z=()=>{if(!f){c({title:"Missing Logo",description:"Please select a logo.",variant:"destructive"});return}const s={id:o||crypto.randomUUID(),name:L,link:w,logoUrl:f};let t;o?t=r.map(a=>a.id===o?s:a):t=[...r,s],T(t)},R=s=>{if(!confirm("Are you sure?"))return;const t=r.filter(a=>a.id!==s);T(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Partners Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage partner logos displayed on homepage."})]}),e.jsxs(d,{onClick:M,disabled:S,children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Add Partner"]})]}),e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsxs(W,{children:[e.jsx(q,{children:e.jsxs(m,{children:[e.jsx(g,{children:"Logo"}),e.jsx(g,{children:"Name"}),e.jsx(g,{children:"Link"}),e.jsx(g,{className:"text-right",children:"Actions"})]})}),e.jsx(V,{children:S?e.jsx(m,{children:e.jsx(i,{colSpan:4,className:"h-24 text-center",children:e.jsx(U,{className:"w-6 h-6 animate-spin mx-auto"})})}):r.length===0?e.jsx(m,{children:e.jsx(i,{colSpan:4,className:"h-24 text-center text-gray-500",children:"No partners defined. Add one to get started."})}):r.map(s=>e.jsxs(m,{children:[e.jsx(i,{children:e.jsx("img",{src:s.logoUrl,alt:s.name,className:"w-16 h-12 object-contain"})}),e.jsx(i,{className:"font-medium",children:s.name||"—"}),e.jsx(i,{children:s.link?e.jsxs("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-500 hover:underline",children:[s.link," ",e.jsx(J,{className:"w-3 h-3 ml-1"})]}):"—"}),e.jsxs(i,{className:"text-right space-x-2",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>F(s),children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx(d,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>R(s.id),children:e.jsx(ie,{className:"w-4 h-4"})})]})]},s.id))})]})}),e.jsx(_,{open:I,onOpenChange:l,children:e.jsxs(G,{children:[e.jsx(K,{children:e.jsx(Q,{children:o?"Edit Partner":"Add Partner"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Partner Name"}),e.jsx(A,{value:L,onChange:s=>p(s.target.value),placeholder:"e.g. My Company"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Website Link"}),e.jsx(A,{value:w,onChange:s=>u(s.target.value),placeholder:"https://example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Logo"}),e.jsx($,{value:f,onChange:j})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-2",children:[e.jsx(d,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(d,{onClick:z,disabled:C,children:[C&&e.jsx(U,{className:"w-4 h-4 animate-spin mr-2"}),o?"Update":"Add"]})]})]})]})})]})}export{ue as default};
