import{r,b as C,j as e,g as v,I as E,B as f,L as T,n as _,X as F,a as P,O as y}from"./index-5Ta4aRjS.js";import{u as M,c as O,g as B,d as I}from"./posts-DO96xuZT.js";import{T as L}from"./textarea-ilOXYFc3.js";import{M as U}from"./MediaPicker-CLx5LbGH.js";import{R as A}from"./quill.snow-Dz0E5nxt.js";import{B as k}from"./badge-BREQvJs4.js";import{C as G,a as q}from"./collapsible-nMoCXgVZ.js";import{P as z}from"./plus-Bijg6d9K.js";import{C as D}from"./calendar-DvrmzHSb.js";import{G as R}from"./globe-D2EIdiAX.js";import{S as H}from"./square-pen-D5d0drwR.js";import{T as J}from"./trash-2-DVI0TkkT.js";import"./check-e8s8MOmU.js";import"./chevron-right-BFnBlNv6.js";import"./isEqual-BI02p-GC.js";const K={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image","code-block"],["clean"]]},V=["header","bold","italic","underline","strike","list","bullet","link","image","code-block"],W=({post:t,onSuccess:b})=>{const[h,d]=r.useState(""),[c,l]=r.useState(""),[o,m]=r.useState(""),[n,x]=r.useState(0),[w,u]=r.useState(""),[p,s]=r.useState(!1),{toast:i}=C();r.useEffect(()=>{var a,g;if(t){d(t.title.rendered),l(t.content.rendered);const N=t.excerpt.rendered.replace(/<[^>]*>?/gm,"").replace(/&nbsp;/g," ").replace(/&hellip;/g,"...").trim();m(N),x(t.featured_media);const S=(g=(a=t._embedded)==null?void 0:a["wp:featuredmedia"])==null?void 0:g[0];S&&u(S.source_url)}else d(""),l(""),m(""),x(0),u("")},[t]);const j=async a=>{a.preventDefault(),s(!0);const g={title:h,content:c,excerpt:o,status:"publish",featured_media:n>0?n:void 0};try{t?(await M(t.id,g),i({title:"Success",description:"Post updated successfully"})):(await O(g),i({title:"Success",description:"Post created successfully"})),b()}catch(N){console.error("Post save error:",N),i({title:"Error",description:"Failed to save post. Check permissions.",variant:"destructive"})}finally{s(!1)}};return e.jsx("form",{onSubmit:j,className:"flex flex-col gap-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"title",className:"text-sm font-semibold text-gray-700",children:"Post Title"}),e.jsx(E,{id:"title",value:h,onChange:a=>d(a.target.value),placeholder:"e.g. 5 Tips for Outdoor Training",required:!0,className:"text-lg font-medium py-6 border-gray-200 focus:border-primary focus:ring-primary/20 transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"content",className:"text-sm font-semibold text-gray-700",children:"Body Content"}),e.jsx("div",{className:"min-h-[300px] lg:min-h-[400px] mb-14 lg:mb-12 border rounded-lg border-gray-200 overflow-hidden bg-white shadow-sm transition-all focus-within:ring-2 focus-within:ring-primary/10",children:e.jsx(A,{theme:"snow",value:c,onChange:l,modules:K,formats:V,className:"h-full border-0"})})]})]}),e.jsxs("div",{className:"space-y-8 border-t pt-8 lg:pt-0 lg:border-t-0 lg:border-l lg:pl-8 border-gray-100 pb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(v,{className:"text-sm font-semibold text-gray-700 uppercase tracking-wider",children:"Featured Image"})}),e.jsx("div",{className:"bg-gray-50/50 p-4 rounded-xl border border-dashed border-gray-300 transition-colors hover:bg-gray-50",children:e.jsx(U,{value:w,onChange:u,onSelectMedia:a=>x(a.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(v,{htmlFor:"excerpt",className:"text-sm font-semibold text-gray-700 uppercase tracking-wider text-xs",children:"Excerpt / Summary"}),e.jsx(L,{id:"excerpt",value:o,onChange:a=>m(a.target.value),placeholder:"A brief summary for cards and search engines...",className:"min-h-[120px] resize-none border-gray-200 bg-white shadow-sm focus:border-primary focus:ring-primary/20"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Short summary displayed on the blog listing page."})]}),e.jsx("div",{className:"pt-4 sticky bottom-0 bg-white/80 backdrop-blur-sm",children:e.jsx(f,{type:"submit",disabled:p,className:"w-full py-6 text-base font-bold shadow-lg shadow-primary/20 hover:scale-[1.02] active:scale-[0.98] transition-all",children:p?e.jsx(T,{className:"w-5 h-5 animate-spin mr-2"}):t?"Update & Sync Post":"Publish New Post"})})]})]})})},ce=()=>{const[t,b]=r.useState([]),[h,d]=r.useState(!0),{toast:c}=C(),[l,o]=r.useState(!1),[m,n]=r.useState(null),x=async()=>{d(!0);try{const s=await B(1,100);b(s)}catch(s){console.error("Failed to fetch posts:",s),c({title:"Greška",description:"Nije uspjelo učitavanje objava.",variant:"destructive"})}finally{d(!1)}};r.useEffect(()=>{x()},[]);const w=async s=>{if(confirm("Jeste li sigurni da želite obrisati ovu objavu?"))try{await I(s),b(t.filter(i=>i.id!==s)),c({title:"Uspjeh",description:"Objava je uspješno obrisana"})}catch{c({title:"Greška",description:"Nije uspjelo brisanje objave",variant:"destructive"})}},u=s=>{n(s),o(!0),window.scrollTo({top:0,behavior:"smooth"})},p=()=>{l?(o(!1),n(null)):(n(null),o(!0))};return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-10 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-slate-200/60 pb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-4xl font-black font-heading text-slate-900 tracking-tight uppercase",children:"BLOG OBJAVE"}),e.jsx("p",{className:"text-slate-500 text-sm md:text-lg font-medium mt-1",children:"Kreirajte, uredite i upravljajte blog sadržajem."})]}),e.jsxs(f,{onClick:p,className:_("h-12 w-full md:w-auto px-6 rounded-full font-black text-xs uppercase tracking-widest shadow-lg transition-all shadow-primary/10",l?"bg-slate-900":"bg-primary"),children:[l?e.jsx(F,{className:"w-4 h-4 mr-2"}):e.jsx(z,{className:"w-4 h-4 mr-2"}),l?"Zatvori Editor":"Nova Objava"]})]}),e.jsx(G,{open:l,children:e.jsx(q,{children:e.jsx(P,{className:"border-none shadow-xl shadow-slate-200/40 bg-white rounded-[2rem] md:rounded-[2.5rem] overflow-hidden mb-12",children:e.jsxs("div",{className:"p-4 md:p-10 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 tracking-tight uppercase",children:m?"Uredi Objavu":"Nova Blog Objava"}),e.jsx(k,{variant:"secondary",className:"bg-slate-50 text-slate-400 font-bold uppercase tracking-widest text-[9px] px-3 py-1",children:"WordPress Editor"})]}),e.jsx(W,{post:m,onSuccess:()=>{o(!1),n(null),x()}})]})})})}),e.jsxs("div",{className:"space-y-4",children:[h?e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 animate-pulse gap-4",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-slate-50 flex items-center justify-center",children:e.jsx(y,{className:"w-8 h-8 text-slate-200"})}),e.jsx("p",{className:"text-slate-400 font-black uppercase tracking-widest text-[10px]",children:"Učitavanje objava..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map(s=>{var i,j,a;return e.jsxs(P,{className:"group hover:shadow-xl hover:shadow-slate-300/40 transition-all duration-500 border-none bg-white flex flex-col overflow-hidden rounded-[2.5rem] shadow-lg shadow-slate-200/30",children:[(a=(j=(i=s._embedded)==null?void 0:i["wp:featuredmedia"])==null?void 0:j[0])!=null&&a.source_url?e.jsxs("div",{className:"h-64 w-full bg-slate-100 overflow-hidden relative",children:[e.jsx("img",{src:s._embedded["wp:featuredmedia"][0].source_url,alt:"Featured",className:"w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"}),e.jsx("div",{className:"absolute top-6 right-6",children:e.jsx(k,{className:"bg-slate-900/80 backdrop-blur-md text-white border-none shadow-xl font-black text-[9px] uppercase tracking-[0.2em] px-4 py-2 rounded-full",children:"Published"})})]}):e.jsxs("div",{className:"h-64 w-full bg-slate-50 flex items-center justify-center relative border-b border-slate-100",children:[e.jsx(y,{className:"w-12 h-12 text-slate-200"}),e.jsx("div",{className:"absolute top-6 right-6",children:e.jsx(k,{className:"bg-slate-400/80 backdrop-blur-md text-white border-none shadow-xl font-black text-[9px] uppercase tracking-[0.2em] px-4 py-2 rounded-full",children:"No Image"})})]}),e.jsxs("div",{className:"p-6 md:p-10 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-6",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-50 flex items-center justify-center",children:e.jsx(D,{className:"w-3.5 h-3.5"})}),new Date(s.date).toLocaleDateString("hr-HR",{day:"numeric",month:"long",year:"numeric"})]}),e.jsx("h3",{className:"text-2xl font-black mb-4 line-clamp-2 leading-tight tracking-tight text-slate-900 group-hover:text-primary transition-colors cursor-pointer",dangerouslySetInnerHTML:{__html:s.title.rendered},onClick:()=>u(s)}),e.jsx("div",{className:"text-slate-500 text-sm font-medium line-clamp-3 mb-10 flex-1 leading-relaxed opacity-80",dangerouslySetInnerHTML:{__html:s.excerpt.rendered}}),e.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-slate-50 mt-auto",children:[e.jsxs("a",{href:`https://wp.dispet.fun/${s.slug}`,target:"_blank",rel:"noreferrer",className:"text-[9px] font-black uppercase tracking-[0.2em] text-slate-400 hover:text-primary flex items-center gap-2.5 transition-all group/link",children:[e.jsx(R,{className:"w-4 h-4 opacity-50 group-hover/link:rotate-12 transition-transform"})," Web Pregled"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 rounded-full bg-slate-50 hover:bg-slate-900 hover:text-white text-slate-600 transition-all shadow-sm",onClick:()=>u(s),children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx(f,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 rounded-full bg-rose-50 hover:bg-rose-500 hover:text-white text-rose-500 transition-all shadow-sm",onClick:()=>w(s.id),children:e.jsx(J,{className:"w-4 h-4"})})]})]})]})]},s.id)})}),!h&&t.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-40 text-center bg-white rounded-[3rem] border border-dashed border-slate-200 shadow-sm",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-slate-50 flex items-center justify-center mb-8 shadow-inner",children:e.jsx(y,{className:"h-10 w-10 text-slate-300"})}),e.jsx("h3",{className:"text-2xl font-black text-slate-900 tracking-tight uppercase",children:"NEMA OBJAVA"}),e.jsx("p",{className:"text-slate-500 max-w-xs mt-3 font-medium leading-relaxed",children:"Započnite pisanjem vaše prve blog objave klikom na gumb iznad."}),e.jsx(f,{onClick:p,variant:"outline",className:"mt-8 rounded-full px-8 py-6 h-auto font-black text-[10px] uppercase tracking-widest",children:"Kreiraj prvu objavu"})]})]})]})};export{ce as default};
